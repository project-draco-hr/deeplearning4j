{
  DoubleMatrix preAct;
  if (concatBiases) {
    DoubleMatrix concat=DoubleMatrix.concatVertically(W,hBias.transpose());
    preAct=x.mmul(concat);
  }
 else   preAct=x.mmul(W).addiRowVector(hBias);
  DoubleMatrix ret=sigmoid(preAct);
  applyDropOutIfNecessary(ret);
  return ret;
}
