{
  DataSetIterator iter=null;
  if (args.length < 2) {
    iter=new RawMnistDataSetIterator(80,60000);
  }
 else {
    int start=Integer.parseInt(args[1]);
    iter=new RawMnistDataSetIterator(60000,60000);
    DataSet next=iter.next();
    List<DataSet> list=next.asList();
    list=list.subList(start,list.size());
    iter=new ListDataSetIterator(list,10);
  }
  DBN dbn=null;
  List<MultiLayerGradientListener> listeners=new ArrayList<>();
  WeightPlotListener listener=new WeightPlotListener();
  listeners.add(listener);
  Conf c=new Conf();
  c.setFinetuneEpochs(10000);
  c.setFinetuneLearningRate(0.000001);
  c.setLayerSizes(new int[]{500,400,250});
  c.setnIn(784);
  c.setUseAdaGrad(true);
  c.setnOut(10);
  c.setSplit(10);
  c.setMultiLayerClazz(DBN.class);
  c.setUseRegularization(false);
  c.setDeepLearningParams(new Object[]{1,0.000001,1000});
  c.setRenderWeightEpochs(1000);
  c.setMultiLayerGradientListeners(listeners);
  ActorNetworkRunner runner=new ActorNetworkRunner("master",iter);
  runner.setup(c);
  runner.train();
}
