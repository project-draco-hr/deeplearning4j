{
  DataSetIterator iter=null;
  if (args.length < 2) {
    iter=new RawMnistDataSetIterator(800,60000);
  }
 else {
    int start=Integer.parseInt(args[1]);
    iter=new RawMnistDataSetIterator(60000,60000);
    DataSet next=iter.next();
    List<DataSet> list=next.asList();
    list=list.subList(start,list.size());
    iter=new ListDataSetIterator(list,10);
  }
  CDBN dbn=null;
  List<MultiLayerGradientListener> listeners=new ArrayList<>();
  WeightPlotListener listener=new WeightPlotListener();
  Conf c=new Conf();
  c.setFinetuneEpochs(1000);
  c.setFinetuneLearningRate(0.001);
  c.setLayerSizes(new int[]{500,400,250});
  c.setnIn(784);
  c.setUseAdaGrad(true);
  c.setnOut(10);
  c.setSplit(100);
  c.setMultiLayerClazz(CDBN.class);
  c.setUseRegularization(false);
  c.setDeepLearningParams(new Object[]{1,0.001,1000});
  c.setMultiLayerGradientListeners(listeners);
  if (args.length >= 1) {
    dbn=SerializationUtils.readObject(new File(args[0]));
  }
  ActorNetworkRunner runner=dbn == null ? new ActorNetworkRunner("master",iter) : new ActorNetworkRunner("master",iter,dbn);
  runner.setup(c);
  runner.train();
}
