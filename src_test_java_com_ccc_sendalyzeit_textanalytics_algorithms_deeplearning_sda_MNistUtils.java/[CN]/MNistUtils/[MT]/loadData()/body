{
  ClassPathResource resource=new ClassPathResource("/train.csv");
  List<String> lines=IOUtils.readLines(resource.getInputStream());
  int columns=lines.get(0).split(",").length - 1;
  Collections.shuffle(lines);
  Collections.rotate(lines,3);
  DoubleMatrix ret=DoubleMatrix.ones(lines.size(),columns);
  List<String> outcomeTypes=new ArrayList<String>();
  double[][] outcomes=new double[lines.size()][columns];
  for (int i=0; i < lines.size(); i++) {
    String line=lines.get(i);
    String[] split=line.split(",");
    addRow(ret,i,split);
    String outcome=split[0];
    if (!outcomeTypes.contains(outcome))     outcomeTypes.add(outcome);
    double[] rowOutcome=new double[785];
    rowOutcome[outcomeTypes.indexOf(outcome)]=1;
    outcomes[i]=rowOutcome;
  }
  return new Pair<>(ret,new DoubleMatrix(outcomes));
}
