{
  JavaRDD<T>[] splits;
  if (collectTrainingStats)   stats.logSplitStart();
  if (totalObjectCount <= numObjectsPerSplit) {
    splits=(JavaRDD<T>[])Array.newInstance(JavaRDD.class,1);
    splits[0]=data;
  }
 else {
    int numSplits=totalObjectCount / numObjectsPerSplit;
    double[] weights=new double[numSplits];
    for (int i=0; i < weights.length; i++)     weights[i]=1.0 / numSplits;
    splits=data.randomSplit(weights);
  }
  if (collectTrainingStats)   stats.logSplitEnd();
  return splits;
}
