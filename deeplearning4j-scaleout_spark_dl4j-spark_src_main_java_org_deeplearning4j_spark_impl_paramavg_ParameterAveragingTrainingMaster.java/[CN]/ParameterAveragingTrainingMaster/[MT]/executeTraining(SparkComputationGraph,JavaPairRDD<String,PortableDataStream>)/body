{
  if (collectTrainingStats)   stats.logFitStart();
  long totalDataSetObjectCount=trainingData.count();
  int dataSetObjectsPerSplit=getNumDataSetObjectsPerSplit();
  JavaPairRDD<String,PortableDataStream>[] splits=randomSplit((int)totalDataSetObjectCount,dataSetObjectsPerSplit,trainingData);
  int splitNum=1;
  for (  JavaPairRDD<String,PortableDataStream> split : splits) {
    JavaRDD<DataSet> splitData=split.map(new LoadSerializedDataSetFunction());
    JavaRDD<MultiDataSet> splitData2=splitData.map(new DataSetToMultiDataSetFn());
    doIteration(graph,splitData2,splitNum++,splits.length);
  }
  if (collectTrainingStats)   stats.logFitEnd((int)totalDataSetObjectCount);
}
