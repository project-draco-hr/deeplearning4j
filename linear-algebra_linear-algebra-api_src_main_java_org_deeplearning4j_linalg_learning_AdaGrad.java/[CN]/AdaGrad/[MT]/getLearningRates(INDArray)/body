{
  this.gradient=gradient;
  INDArray squaredGradient=pow(this.gradient,2);
  if (this.historicalGradient == null || this.historicalGradient.length() != this.gradient.length())   this.historicalGradient=NDArrays.zeros(this.gradient.rows(),this.gradient.columns());
  this.historicalGradient.addi(squaredGradient);
  numIterations++;
  INDArray sqrtGradient=sqrt(historicalGradient.dup()).add(fudgeFactor);
  INDArray div=abs(gradient).divi(sqrtGradient);
  this.adjustedGradient=div.muli(masterStepSize);
  float sum=this.adjustedGradient.sum(Integer.MAX_VALUE).get(0);
  return adjustedGradient;
}
