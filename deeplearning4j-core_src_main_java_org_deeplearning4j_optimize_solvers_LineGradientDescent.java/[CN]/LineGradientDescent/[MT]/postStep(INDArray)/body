{
  double norm2=gradient.norm2(Integer.MAX_VALUE).getDouble(0);
  if (norm2 > stepMax)   searchState.put(SEARCH_DIR,gradient.dup().muli(stepMax / norm2));
 else   searchState.put(SEARCH_DIR,gradient.dup());
  searchState.put(GRADIENT_KEY,gradient.dup());
}
