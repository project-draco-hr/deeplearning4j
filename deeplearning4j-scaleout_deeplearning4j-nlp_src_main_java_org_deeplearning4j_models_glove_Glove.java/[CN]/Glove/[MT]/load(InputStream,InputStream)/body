{
  LineIterator iter=IOUtils.lineIterator(is,"UTF-8");
  Glove glove=new Glove();
  Map<String,float[]> wordVectors=new HashMap<>();
  int count=0;
  while (iter.hasNext()) {
    String line=iter.nextLine().trim();
    if (line.isEmpty())     continue;
    String[] split=line.split(" ");
    String word=split[0];
    if (glove.vocab() == null)     glove.setVocab(new InMemoryLookupCache());
    if (glove.lookupTable() == null) {
      glove.lookupTable=new GloveWeightLookupTable.Builder().cache(glove.vocab()).vectorLength(split.length - 1).build();
    }
    if (word.isEmpty())     continue;
    float[] read=read(split,glove.lookupTable().getVectorLength());
    if (read.length < 1)     continue;
    VocabWord w1=new VocabWord(1,word);
    glove.layerSize=glove.lookupTable().getVectorLength();
    w1.setIndex(count);
    glove.vocab().addToken(w1);
    glove.vocab().addWordToIndex(count,word);
    glove.vocab().putVocabWord(word);
    wordVectors.put(word,read);
    count++;
  }
  glove.lookupTable().setSyn0(weights(glove,wordVectors));
  iter.close();
  glove.lookupTable().setBias(Nd4j.readTxt(biases," "));
  return glove;
}
