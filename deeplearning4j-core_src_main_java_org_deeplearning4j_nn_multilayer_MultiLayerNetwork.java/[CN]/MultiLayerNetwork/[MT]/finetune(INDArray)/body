{
  if (labels != null)   this.labels=labels;
  if (!(getOutputLayer() instanceof OutputLayer)) {
    log.warn("Output layer not instance of output layer returning.");
    return;
  }
  log.info("Finetune phase");
  OutputLayer o=(OutputLayer)getOutputLayer();
  if (getOutputLayer().conf().getOptimizationAlgo() != OptimizationAlgorithm.HESSIAN_FREE) {
    List<INDArray> activations=feedForward();
    o.fit(activations.get(activations.size() - 2),labels);
  }
 else {
    List<INDArray> activations=feedForward();
    activations.clear();
    o.setLabels(labels);
    StochasticHessianFree hessianFree=new StochasticHessianFree(getOutputLayer().conf(),StepFunctions.createStepFunction(getOutputLayer().conf().getStepFunction()),o.getIterationListeners(),this);
    hessianFree.optimize();
  }
}
