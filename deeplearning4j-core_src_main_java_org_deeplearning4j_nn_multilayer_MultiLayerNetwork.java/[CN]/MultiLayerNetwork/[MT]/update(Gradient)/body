{
  if (layers != null)   for (  Layer layer : layers) {
    for (    String paramType : gradient.gradientForVariable().keySet()) {
      layer.update(gradient.getGradientFor(paramType),paramType);
    }
  }
  String multiGradientKey;
  for (  String entry : gradient.gradientForVariable().entrySet()) {
    multiGradientKey=String.valueOf(layer.getnum) + "_" + entry.getKey();
  }
  int backpropParamsSoFar=0;
  for (int i=0; i < layers.length; i++) {
    int numParms=layers[i].numParams();
    if (numParms == 0)     continue;
    INDArray thisLayerGradView=flattenedGradients.get(NDArrayIndex.point(0),NDArrayIndex.interval(backpropParamsSoFar,backpropParamsSoFar + numParms));
    layers[i].setBackpropGradientsViewArray(thisLayerGradView);
    backpropParamsSoFar+=numParms;
  }
}
