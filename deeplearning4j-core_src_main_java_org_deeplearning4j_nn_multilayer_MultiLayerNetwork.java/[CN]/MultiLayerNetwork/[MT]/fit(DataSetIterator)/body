{
  if (layerWiseConfigurations.isPretrain()) {
    pretrain(iter);
    iter.reset();
    while (iter.hasNext()) {
      DataSet next=iter.next();
      if (next.getFeatureMatrix() == null || next.getLabels() == null)       break;
      setInput(next.getFeatureMatrix());
      setLabels(next.getLabels());
      finetune();
    }
  }
  if (layerWiseConfigurations.isBackprop()) {
    iter.reset();
    while (iter.hasNext()) {
      DataSet next=iter.next();
      if (next.getFeatureMatrix() == null || next.getLabels() == null)       break;
      setInput(next.getFeatureMatrix());
      setLabels(next.getLabels());
      backprop();
    }
  }
}
