{
  MultiLayerNetwork ret;
  try {
    Constructor<MultiLayerNetwork> constructor=(Constructor<MultiLayerNetwork>)getClass().getDeclaredConstructor(MultiLayerConfiguration.class);
    ret=constructor.newInstance(getLayerWiseConfigurations().clone());
    ret.update(this);
    ret.setParameters(params().dup());
    ret.listeners=this.listeners;
  }
 catch (  Exception e) {
    throw new IllegalStateException("Unable to clone network",e);
  }
  return ret;
}
