{
  log.info("Finetune phase ");
  if (layerWiseConfigurations.isBackprop()) {
    log.info("Will use backpropagation for finetune");
    return;
  }
  iter.reset();
  while (iter.hasNext()) {
    DataSet data=iter.next();
    if (data.getFeatureMatrix() == null || data.getLabels() == null)     break;
    setInput(data.getFeatureMatrix());
    setLabels(data.getLabels());
    if (getOutputLayer().conf().getOptimizationAlgo() != OptimizationAlgorithm.HESSIAN_FREE) {
      feedForward();
      if (getOutputLayer() instanceof OutputLayer) {
        OutputLayer o=(OutputLayer)getOutputLayer();
        o.setListeners(getListeners());
        o.fit(o.input(),getLabels());
      }
    }
 else {
      throw new UnsupportedOperationException();
    }
  }
}
