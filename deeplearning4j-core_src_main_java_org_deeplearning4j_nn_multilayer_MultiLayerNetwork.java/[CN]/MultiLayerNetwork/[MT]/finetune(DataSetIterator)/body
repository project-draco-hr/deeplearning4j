{
  log.info("Finetune phase ");
  iter.reset();
  while (iter.hasNext()) {
    DataSet data=iter.next();
    if (data.getFeatureMatrix() == null || data.getLabels() == null)     break;
    setInput(data.getFeatureMatrix());
    setLabels(data.getLabels());
    if (getOutputLayer().conf().getOptimizationAlgo() != OptimizationAlgorithm.HESSIAN_FREE) {
      feedForward();
      if (getOutputLayer() instanceof OutputLayer) {
        OutputLayer o=(OutputLayer)getOutputLayer();
        o.fit();
      }
    }
 else {
      StochasticHessianFree hessianFree=new StochasticHessianFree(getOutputLayer().conf(),getOutputLayer().conf().getStepFunction(),getOutputLayer().conf().getListeners(),this);
      hessianFree.optimize();
    }
  }
}
