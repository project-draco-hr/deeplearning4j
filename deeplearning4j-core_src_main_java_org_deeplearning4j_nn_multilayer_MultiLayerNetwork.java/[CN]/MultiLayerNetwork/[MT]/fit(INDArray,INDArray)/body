{
  setInput(data.dup());
  setLabels(labels.dup());
  if (layerWiseConfigurations.isPretrain()) {
    pretrain(data);
    finetune();
  }
  if (layerWiseConfigurations.isBackprop()) {
    if (solver == null) {
      solver=new Solver.Builder().configure(conf()).listeners(getListeners()).model(this).build();
    }
    solver.optimize();
  }
}
