{
  int idx=0;
  for (int i=0; i < getLayers().length; i++) {
    Layer layer=getLayers()[i];
    int range=layer.numParams();
    INDArray get=params.get(NDArrayIndex.interval(idx,range + idx));
    if (get.length() < 1)     throw new IllegalStateException("Unable to retrieve layer. No params found (length was 0");
    layer.setParams(get);
    layer.computeGradientAndScore();
    idx+=range - 1;
  }
}
