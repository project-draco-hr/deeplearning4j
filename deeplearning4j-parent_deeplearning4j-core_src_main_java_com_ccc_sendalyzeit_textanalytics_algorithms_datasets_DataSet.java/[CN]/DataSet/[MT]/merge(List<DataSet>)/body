{
  if (data.isEmpty())   throw new IllegalArgumentException("Unable to merge empty dataset");
  DataSet first=data.iterator().next();
  DoubleMatrix in=new DoubleMatrix(data.size(),first.getFirst().columns);
  DoubleMatrix out=new DoubleMatrix(data.size(),first.getSecond().columns);
  for (int i=0; i < data.size(); i++) {
    in.putRow(i,data.get(i).getFirst());
    out.putRow(i,data.get(i).getSecond());
  }
  return new DataSet(in,out);
}
