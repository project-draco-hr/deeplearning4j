{
  Path p=new Path(props.getProperty(ConfigFields.APP_INPUT_PATH));
  FileSystem fs=FileSystem.get(conf);
  FileStatus f=fs.getFileStatus(p);
  BlockLocation[] bl=fs.getFileBlockLocations(p,0,f.getLen());
  Set<ConfigurationTuple> configTuples=new HashSet<ConfigurationTuple>();
  int workerId=0;
  for (  BlockLocation b : bl) {
    FileSplit split=FileSplit.newBuilder().setPath(p.toString()).setOffset(b.getOffset()).setLength(b.getLength()).build();
    StartupConfiguration config=StartupConfiguration.newBuilder().setBatchSize(batchSize).setIterations(iterationCount).setOther(appConfig).setSplit(split).build();
    String wid="worker-" + workerId;
    ConfigurationTuple tuple=new ConfigurationTuple(b.getHosts()[0],wid,config);
    configTuples.add(tuple);
    workerId++;
  }
  return configTuples;
}
