{
  for (int i=0; i < numFilters[0]; i++) {
    INDArray reversedSlice=Nd4j.reverse(W.slice(i));
    INDArray slice=Transforms.sigmoid(Convolution.convn(v,reversedSlice,Convolution.Type.VALID).addi(hBias.get(i)));
    hidI.putSlice(i,slice);
  }
  INDArray expHidI=Transforms.exp(hidI.dup());
  INDArray eHid=expHidI.div(pool(expHidI).add(1));
  this.eHid=eHid;
  return eHid;
}
