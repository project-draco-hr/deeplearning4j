{
  if (Arrays.equals(nd.shape(),targetShape))   return nd;
  if (ArrayUtil.prod(nd.shape()) == ArrayUtil.prod(targetShape))   return nd.reshape(targetShape);
  ComplexNDArray ret=new ComplexNDArray(targetShape);
  if (ret.isScalar())   return nd.slice(0);
  if (ret.isVector()) {
    for (int i=0; i < nd.slices(); i++) {
      for (int j=0; j < ret.length; j++) {
        ret.put(i,nd.get(i,j));
      }
    }
    return ret;
  }
  int[] sliceShape=ArrayUtil.removeIndex(targetShape,0);
  for (int i=0; i < ret.slices(); i++) {
    ComplexNDArray put=truncate(nd.slice(i),sliceShape);
    ret.putSlice(i,put);
  }
  return ret;
}
