{
  ensureValidOutcomeMatrix(y);
  this.input=x;
  this.labels=y;
  if (x.rows != y.rows)   throw new IllegalArgumentException("Can't train on the 2 given inputs and labels");
  DoubleMatrix p_y_given_x=softmax(x.mmul(W).addRowVector(b));
  DoubleMatrix dy=y.sub(p_y_given_x);
  W=W.add(x.transpose().mmul(dy).mul(lr));
  b=b.add(dy.columnMeans().mul(lr));
}
