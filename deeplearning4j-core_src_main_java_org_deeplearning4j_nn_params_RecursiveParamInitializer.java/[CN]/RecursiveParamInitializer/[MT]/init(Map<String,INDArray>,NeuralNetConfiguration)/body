{
  Distribution dist=Distributions.createDistribution(conf.getDist());
  int vis=conf.getNOut();
  int out=vis * 2;
  params.put(W,WeightInitUtil.initWeights(new int[]{out,vis},conf.getWeightInit(),dist));
  params.put(U,WeightInitUtil.initWeights(new int[]{vis,out},conf.getWeightInit(),dist));
  params.put(BIAS,WeightInitUtil.initWeights(new int[]{out},conf.getWeightInit(),dist));
  params.put(C,WeightInitUtil.initWeights(new int[]{vis},conf.getWeightInit(),dist));
  conf.addVariable(W);
  conf.addVariable(U);
  conf.addVariable(BIAS);
  conf.addVariable(C);
}
