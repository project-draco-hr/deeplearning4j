{
  this.gradient=gradient.dup();
  DoubleMatrix gradientsSquared=MatrixFunctions.pow(gradient,2);
  if (first) {
    this.historicalGradient=gradientsSquared;
    first=false;
  }
 else   this.historicalGradient.addi(gradientsSquared);
  DoubleMatrix gAdd=MatrixFunctions.sqrt(historicalGradient).add(fudgeFactor);
  this.adjustedGradient=this.gradient.div(gAdd);
  this.adjustedGradient.muli(masterStepSize);
  return adjustedGradient.neg();
}
