{
  this.gradient=MatrixFunctions.abs(gradient.dup());
  double currentLearningRate=this.masterStepSize;
  DoubleMatrix gradientSquared=MatrixFunctions.pow(this.gradient,2);
  this.historicalGradient.addi(gradientSquared);
  DoubleMatrix sqrtHistoricalGradient=MatrixFunctions.sqrt(historicalGradient).add(fudgeFactor);
  this.adjustedGradient=this.gradient.div(sqrtHistoricalGradient).mul(currentLearningRate);
  return adjustedGradient;
}
