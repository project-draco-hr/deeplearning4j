{
  this.gradient=gradient;
  DoubleMatrix squaredGradient=pow(this.gradient,2);
  if (this.historicalGradient == null || this.historicalGradient.length != this.gradient.length)   this.historicalGradient=DoubleMatrix.zeros(this.gradient.rows,this.gradient.columns);
  this.historicalGradient.addi(squaredGradient);
  numIterations++;
  DoubleMatrix sqrtGradient=sqrt(historicalGradient).add(fudgeFactor);
  DoubleMatrix div=abs(gradient).div(sqrtGradient);
  this.adjustedGradient=div.mul(masterStepSize);
  return adjustedGradient;
}
