{
  this.gradient=gradient;
  DoubleMatrix gradientsSquared=MatrixFunctions.pow(gradient,2);
  if (first) {
    this.historicalGradient=gradientsSquared;
    first=false;
  }
 else   this.historicalGradient=historicalGradient.add(gradientsSquared);
  DoubleMatrix gAdd=MatrixFunctions.sqrt(historicalGradient).add(fudgeFactor);
  this.adjustedGradient=gradient.div(gAdd);
  this.adjustedGradient.muli(masterStepSize).negi();
  return adjustedGradient;
}
