{
  INDArray inputTimesW=input.mmul(W);
  INDArray preSigH=input.mmul(W).addRowVector(hBias);
  INDArray sigH=sigmoid(preSigH.dup());
  INDArray preSigV=sigH.mmul(W.transpose()).addRowVector(vBias);
  INDArray sigV=sigmoid(preSigV.dup());
  INDArray inner=input.mul(log(sigV.dup())).addi(input.rsub(1).muli(log(sigV.rsubi(1))));
  INDArray rows=inner.sum(0);
  INDArray mean=rows.mean(Integer.MAX_VALUE);
  double ret=(double)inner.sum(0).mean(Integer.MAX_VALUE).element();
  ret/=input.rows();
  return ret;
}
