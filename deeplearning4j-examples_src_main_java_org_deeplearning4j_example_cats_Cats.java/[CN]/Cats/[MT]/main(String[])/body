{
  DataSetIterator iter=new CatsDataSetIterator(new File(args[0]),10,10);
  DBN dbn=new DBN.Builder().withHiddenUnits(RBM.HiddenUnit.RECTIFIED).withVisibleUnits(RBM.VisibleUnit.GAUSSIAN).hiddenLayerSizes(new int[]{600}).numberOfInputs(iter.inputColumns()).numberOfOutPuts(10).build();
  while (iter.hasNext()) {
    DataSet next=iter.next();
    next.normalizeZeroMeanZeroUnitVariance();
    dbn.pretrain(next.getFirst(),1,1e-1,10000);
    FilterRenderer render=new FilterRenderer();
    DoubleMatrix w=dbn.getLayers()[0].getW();
    render.renderFilters(w,"currimg.png",(int)Math.sqrt(w.rows),(int)Math.sqrt(w.rows),10);
  }
}
