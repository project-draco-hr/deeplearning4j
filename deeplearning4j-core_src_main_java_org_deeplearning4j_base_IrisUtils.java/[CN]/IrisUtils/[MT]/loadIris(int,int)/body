{
  ClassPathResource resource=new ClassPathResource("/iris.dat");
  @SuppressWarnings("unchecked") List<String> lines=IOUtils.readLines(resource.getInputStream());
  List<DataSet> list=new ArrayList<>();
  INDArray ret=Nd4j.ones(Math.abs(to - from),4);
  List<String> outcomeTypes=new ArrayList<>();
  double[][] outcomes=new double[lines.size()][3];
  int putCount=0;
  for (int i=from; i < to; i++) {
    String line=lines.get(i);
    String[] split=line.split(",");
    addRow(ret,putCount++,split);
    String outcome=split[split.length - 1];
    if (!outcomeTypes.contains(outcome))     outcomeTypes.add(outcome);
    double[] rowOutcome=new double[3];
    rowOutcome[outcomeTypes.indexOf(outcome)]=1;
    outcomes[i]=rowOutcome;
  }
  for (int i=0; i < ret.rows(); i++)   list.add(new DataSet(ret.getRow(i),Nd4j.create(outcomes[i])));
  return list;
}
