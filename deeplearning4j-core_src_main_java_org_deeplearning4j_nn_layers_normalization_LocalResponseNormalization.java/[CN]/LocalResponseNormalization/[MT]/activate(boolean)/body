{
  k=layerConf().getK();
  n=layerConf().getN();
  alpha=layerConf().getAlpha();
  beta=layerConf().getBeta();
  halfN=(int)n / 2;
  int channel=input.shape()[1];
  INDArray tmp, addVal;
  INDArray activitySqr=input.mul(input);
  INDArray sumPart=activitySqr.dup();
  for (int i=1; i < halfN + 1; i++) {
    tmp=sumPart.get(new INDArrayIndex[]{NDArrayIndex.all(),interval(i,channel),NDArrayIndex.all(),NDArrayIndex.all()});
    addVal=activitySqr.get(new INDArrayIndex[]{NDArrayIndex.all(),interval(0,channel - i),NDArrayIndex.all(),NDArrayIndex.all()});
    sumPart.put(new INDArrayIndex[]{NDArrayIndex.all(),interval(i,channel),NDArrayIndex.all(),NDArrayIndex.all()},tmp.addi(addVal));
    tmp=sumPart.get(new INDArrayIndex[]{NDArrayIndex.all(),interval(0,channel - i),NDArrayIndex.all(),NDArrayIndex.all()});
    addVal=activitySqr.get(new INDArrayIndex[]{NDArrayIndex.all(),interval(i,channel),NDArrayIndex.all(),NDArrayIndex.all()});
    sumPart.put(new INDArrayIndex[]{NDArrayIndex.all(),interval(0,channel - i),NDArrayIndex.all(),NDArrayIndex.all()},tmp.addi(addVal));
  }
  unitScale=sumPart.mul(alpha).add(k);
  scale=Transforms.pow(unitScale,-beta);
  activations=input.mul(scale);
  return activations;
}
