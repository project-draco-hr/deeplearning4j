{
  for (  String worker : stateTracker.workers())   stateTracker.enableWorker(worker);
  int split=stateTracker.inputSplit();
  final List<List<DataSet>> splitList=Lists.partition(datasets,split);
  log.info("Found partition of size " + stateTracker.partition());
  Set<String> workerDelegated=new HashSet<>();
  for (int i=0; i < splitList.size(); i++) {
    final List<DataSet> wrap=splitList.get(i);
    final List<DataSet> work=new ArrayList<>(wrap);
    delegateJob(work,workerDelegated);
    log.info("Sending off work for batch " + i);
  }
}
