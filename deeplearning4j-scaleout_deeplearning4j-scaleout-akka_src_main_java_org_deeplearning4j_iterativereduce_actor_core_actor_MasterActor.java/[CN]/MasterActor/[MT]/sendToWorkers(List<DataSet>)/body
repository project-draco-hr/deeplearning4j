{
  int split=this.getConf().getSplit();
  final List<List<DataSet>> splitList=Lists.partition(datasets,split);
  partition=splitList.size();
  log.info("Found partition of size " + partition);
  for (int i=0; i < splitList.size(); i++) {
    final List<DataSet> wrap=splitList.get(i);
    scala.concurrent.Future<Void> f=Futures.future(new Callable<Void>(){
      @Override public Void call() throws Exception {
        final List<DataSet> work=new ArrayList<>(wrap);
        delegateJob(work);
        return null;
      }
    }
,context().dispatcher());
    ActorRefUtils.throwExceptionIfExists(f,context().dispatcher());
    log.info("Sending off work for batch " + i);
  }
}
