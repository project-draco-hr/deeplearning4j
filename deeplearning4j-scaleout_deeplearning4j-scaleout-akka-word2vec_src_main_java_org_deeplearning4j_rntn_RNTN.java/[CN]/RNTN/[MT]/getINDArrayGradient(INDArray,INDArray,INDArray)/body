{
  int size=deltaFull.length();
  INDArray Wt_df=NDArrays.create(new int[]{size * 2,size * 2,size});
  INDArray fullVector=NDArrays.concatHorizontally(leftVector,rightVector);
  for (int slice=0; slice < size; ++slice) {
    Wt_df.putSlice(slice,NDArrays.getBlasWrapper().scal((double)deltaFull.getScalar(slice).element(),fullVector).mmul(fullVector.transpose()));
  }
  return Wt_df;
}
