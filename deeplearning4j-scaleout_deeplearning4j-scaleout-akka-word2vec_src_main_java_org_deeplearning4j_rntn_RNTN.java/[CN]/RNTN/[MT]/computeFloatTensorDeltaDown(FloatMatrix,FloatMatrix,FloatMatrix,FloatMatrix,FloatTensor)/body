{
  FloatMatrix WTDelta=W.transpose().mmul(deltaFull);
  FloatMatrix WTDeltaNoBias=WTDelta.get(interval(0,1),interval(0,deltaFull.rows * 2));
  int size=deltaFull.length;
  FloatMatrix deltaFloatTensor=new FloatMatrix(size * 2,1);
  FloatMatrix fullVector=FloatMatrix.concatHorizontally(leftVector,rightVector);
  for (int slice=0; slice < size; ++slice) {
    FloatMatrix scaledFullVector=SimpleBlas.scal(deltaFull.get(slice),fullVector);
    deltaFloatTensor=deltaFloatTensor.add(Wt.getSlice(slice).add(Wt.getSlice(slice).transpose()).mmul(scaledFullVector));
  }
  return deltaFloatTensor.add(WTDeltaNoBias);
}
