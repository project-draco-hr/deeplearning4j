{
  UpdateableImpl masterResults=null;
  List<UpdateableImpl> updates=stateTracker.updates();
  if (!updates.isEmpty()) {
    masterResults=compute(updates,updates);
    stateTracker.setCurrent(masterResults);
    epochsComplete++;
    stateTracker.updates().clear();
  }
 else   masterResults=getMasterResults();
  if (stateTracker.isPretrain() && stateTracker.currentJobs().isEmpty()) {
    log.info("Switching to finetune mode");
    pretrain=false;
    stateTracker.moveToFinetune();
    SerializationUtils.saveObject(masterResults.get(),new File("pretrain-model.bin"));
    batchActor.tell(ResetMessage.getInstance(),getSelf());
    batchActor.tell(new MoreWorkMessage(masterResults),getSelf());
  }
 else   if (stateTracker.currentJobs().isEmpty()) {
    isDone=true;
    stateTracker.finish();
    log.info("Done training!");
  }
}
