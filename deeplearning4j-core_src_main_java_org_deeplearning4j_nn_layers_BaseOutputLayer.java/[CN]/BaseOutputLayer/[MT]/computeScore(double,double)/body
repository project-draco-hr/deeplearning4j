{
  if (input == null || labels == null)   throw new IllegalStateException("Cannot calculate score without input and labels");
  this.fullNetworkL1=fullNetworkL1;
  this.fullNetworkL2=fullNetworkL2;
  INDArray preOut=preOutput2d(input,true);
  INDArray output=Nd4j.getExecutioner().execAndReturn(Nd4j.getOpFactory().createTransform(conf().getLayer().getActivationFunction(),preOut.dup()));
  setScore(output,preOut);
  return score;
}
