{
  if (input == null)   throw new IllegalArgumentException("No null input allowed");
  INDArray preOutput=preOutput2d(input,training);
  if (conf.getLayer().getActivationFunction().equals("softmax")) {
    SoftMax softMax=new SoftMax(preOutput);
    softMax.exec(1);
    return softMax.z();
  }
  if (training)   applyDropOutIfNecessary(input(),training);
  return super.activate(true);
}
