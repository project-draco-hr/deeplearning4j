{
  if (historicalGradient == null) {
    historicalGradient=Nd4j.zeros(getCodes().length);
  }
  double pow=Math.pow(g,2);
  historicalGradient.putScalar(index,historicalGradient.getDouble(index) + pow);
  double sqrt=FastMath.sqrt(historicalGradient.getDouble(index));
  double abs=FastMath.abs(g) / (sqrt + 1e-6f);
  double ret=abs * 1e-1f;
  return ret;
}
