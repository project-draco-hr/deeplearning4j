{
  FloatMatrix l1=syn0.getRow(w2.getIndex());
  FloatMatrix l2a=syn1.getRows(w1.getCodes());
  FloatMatrix fa=MatrixUtil.sigmoid(MatrixUtil.dot(l1,l2a.transpose()));
  FloatMatrix ga=FloatMatrix.ones(fa.length).sub(MatrixUtil.toFloatMatrix(w1.getCodes())).sub(fa).mul(alpha);
  FloatMatrix outer=ga.mmul(l1);
  for (int i=0; i < w1.getPoints().length; i++) {
    FloatMatrix toAdd=l2a.getRow(i).add(outer.getRow(i));
    syn1.putRow(w1.getPoints()[i],toAdd);
  }
  FloatMatrix updatedInput=l1.add(MatrixUtil.dot(ga,l2a));
  syn0.putRow(w2.getIndex(),updatedInput);
}
