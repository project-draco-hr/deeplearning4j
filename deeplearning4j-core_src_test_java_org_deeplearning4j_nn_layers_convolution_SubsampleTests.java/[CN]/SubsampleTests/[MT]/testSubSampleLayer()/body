{
  DataSetIterator mnistIter=new MnistDataSetIterator(100,100);
  DataSet mnist=mnistIter.next();
  NeuralNetConfiguration conf=new NeuralNetConfiguration.Builder().activationFunction("relu").constrainGradientToUnitNorm(true).poolingType(SubsamplingLayer.PoolingType.MAX).layer(new SubsamplingLayer()).nIn(784).nOut(1).build();
  Layer model=LayerFactories.getFactory(new SubsamplingLayer()).create(conf);
  INDArray input=mnist.getFeatureMatrix().reshape(mnist.numExamples(),1,28,28);
  input=input.get(NDArrayIndex.all(),NDArrayIndex.all(),NDArrayIndex.interval(0,20),NDArrayIndex.interval(0,20));
  INDArray output=model.activate(input);
  assertTrue(Arrays.equals(new int[]{mnist.numExamples(),1,10,21},output.shape()));
}
