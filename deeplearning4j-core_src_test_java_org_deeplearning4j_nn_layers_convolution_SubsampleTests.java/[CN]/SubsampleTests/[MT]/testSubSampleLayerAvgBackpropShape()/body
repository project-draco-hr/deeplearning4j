{
  Layer model=getSubsamplingLayer(SubsamplingLayer.PoolingType.AVG);
  Gradient gradient=createPrevGradient();
  DataSetIterator mnistIter=new MnistDataSetIterator(nExamples,nExamples);
  DataSet mnist=mnistIter.next();
  INDArray input=mnist.getFeatureMatrix().reshape(mnist.numExamples(),1,28,28);
  INDArray activations=model.activate(input);
  Pair<Gradient,INDArray> out=model.backpropGradient(epsilon,gradient,null);
  assertEquals(4,out.getSecond().shape().length);
  assertEquals(20,out.getSecond().size(0));
}
