{
  if (decoder == null)   initDecoder();
  DoubleMatrix encode=encode(input);
  DoubleMatrix decoderInput=isRoundCodeLayerInput() ? round(sigmoid(encode)) : sigmoid(encode);
  decoder.setInput(decoderInput);
  decoder.initializeLayers(decoderInput);
  decoder.finetune(input,lr,epochs);
}
