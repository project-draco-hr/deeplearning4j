{
  Scheme scheme=getScheme();
  RecordReader recordReader=scheme.createReader(new ClassPathResource("iris.txt").getURI());
  assertTrue(recordReader.hasNext());
  while (recordReader.hasNext()) {
    Collection<Writable> record=recordReader.next();
    assertEquals(1,record.size());
  }
  recordReader=scheme.createReader(new ClassPathResource("iris.txt").getURI());
  List<Collection<Writable>> records=new ArrayList<>();
  int count=0;
  RecordWriter writer=scheme.createWriter(URI.create("test_out.txt"));
  for (  Collection<Writable> record : records) {
    writer.write(record);
    assertEquals(1,record.size());
  }
  recordReader=scheme.createReader(URI.create("test_out.txt"));
  while (recordReader.hasNext()) {
    Collection<Writable> record=recordReader.next();
    records.add(record);
    assertEquals(1,record.size());
    count++;
  }
  assertEquals(1,count);
  writer.close();
}
