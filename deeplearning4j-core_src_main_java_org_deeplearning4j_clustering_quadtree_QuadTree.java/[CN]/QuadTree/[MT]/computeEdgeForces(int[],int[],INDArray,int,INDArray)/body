{
  double D;
  for (int n=0; n < N; n++) {
    for (int i=rowP[n]; i < rowP[n + 1]; i++) {
      buf.assign(data.slice(n)).subi(data.slice(colP[i]));
      D=Nd4j.getBlasWrapper().dot(buf,buf);
      D=valP.getDouble(i) / (1.0 + D);
      posF.slice(n).addi(buf.mul(D));
    }
  }
}
