{
  input=input.sub(input.max());
  input=MatrixFunctions.exp(input);
  if (input.columns == 1) {
    DoubleMatrix sum=sum(input,0);
    return input.divi(sum);
  }
 else {
    DoubleMatrix sum=sum(input,1).transpose();
    return input.diviColumnVector(sum);
  }
}
