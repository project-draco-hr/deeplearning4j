{
  DoubleMatrix corrupted=this.getCorruptedInput(input,corruptionLevel);
  DoubleMatrix y=this.getHiddenValues(corrupted);
  DoubleMatrix z=this.getReconstructedInput(y);
  DoubleMatrix inside=input.mul(MatrixUtil.log(z)).add(MatrixUtil.oneMinus(input).mul(MatrixUtil.log(MatrixUtil.oneMinus(z))));
  return -inside.columnSums().mean();
}
