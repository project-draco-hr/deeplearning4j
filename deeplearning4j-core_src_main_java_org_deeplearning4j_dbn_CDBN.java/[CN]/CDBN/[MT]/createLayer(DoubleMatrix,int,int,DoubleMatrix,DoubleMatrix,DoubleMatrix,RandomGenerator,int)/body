{
  if (index == 0)   return new CRBM.Builder().useRegularization(isUseRegularization()).withDistribution(getDist()).useAdaGrad(isUseAdaGrad()).withHBias(hBias).numberOfVisible(nVisible).numHidden(nHidden).withSparsity(getSparsity()).withInput(input).withL2(getL2()).fanIn(getFanIn()).renderWeights(getRenderWeightsEveryNEpochs()).withRandom(rng).withWeights(W).build();
 else   return new RBM.Builder().useAdaGrad(isUseAdaGrad()).useRegularization(isUseRegularization()).withDistribution(getDist()).withHBias(hBias).numberOfVisible(nVisible).numHidden(nHidden).withSparsity(getSparsity()).withInput(input).withL2(getL2()).fanIn(getFanIn()).renderWeights(getRenderWeightsEveryNEpochs()).withRandom(rng).withWeights(W).build();
}
