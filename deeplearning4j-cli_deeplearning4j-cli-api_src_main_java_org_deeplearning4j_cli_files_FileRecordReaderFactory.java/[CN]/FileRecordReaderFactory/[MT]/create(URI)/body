{
  Preconditions.checkArgument(uri != null,"URI cannot be null");
  File file=new File(uri.toString());
  InputSplit split=new FileSplit(file);
  String fileNameExtension=FilenameUtils.getExtension(uri.toString()).toLowerCase();
  RecordReader ret=null;
switch (fileNameExtension) {
case "csv":
    ret=new CSVRecordReader();
  break;
case "txt":
ret=new FileRecordReader();
break;
case "mat":
ret=new MatlabRecordReader();
break;
case "svmlight":
ret=new SVMLightRecordReader();
break;
default :
throw new UnknownFormatException("Unknown file format");
}
try {
ret.initialize(split);
}
 catch (Exception e) {
throw new RuntimeException(e);
}
return ret;
}
