{
  this.N=N;
  this.n_visible=n_visible;
  this.n_hidden=n_hidden;
  if (rng == null)   this.rng=new Random(1234);
 else   this.rng=rng;
  if (W == null)   this.W=DoubleMatrix.randn(n_hidden,n_visible);
 else   if (W.rows != n_hidden && W.columns != n_visible)   throw new IllegalArgumentException("Illegal weight vector; The number of rows are not equal to " + n_hidden + " or the number of columns aren't equal to "+ n_visible+ " dimensions were "+ W.rows+ " x "+ W.columns);
 else   this.W=W;
  if (hbias == null)   this.hbias=DoubleMatrix.zeros(n_hidden);
 else   if (hbias.length != n_hidden)   throw new IllegalArgumentException("Hidden bias must have a length of " + n_hidden + " length was "+ hbias.length);
 else   this.hbias=hbias;
  if (vbias == null)   this.vbias=DoubleMatrix.zeros(n_visible);
 else   if (vbias.length != n_visible)   throw new IllegalArgumentException("Visible bias must have a length of " + n_visible + " but length was "+ vbias.length);
 else   this.vbias=vbias;
}
