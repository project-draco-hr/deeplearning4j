{
  INDArray currInput=this.input;
  List<INDArray> activations=new ArrayList<>();
  activations.add(currInput);
  NeuralNetwork[] layers=getNeuralNets();
  for (int i=0; i < layers.length; i++) {
    AutoEncoder layer=(AutoEncoder)getNeuralNets()[i];
    layer.setInput(currInput);
    if (layerWiseConfigurations.get(i).isUseHiddenActivationsForwardProp()) {
      currInput=layer.transform(currInput);
    }
 else     if (sampleFromHiddenActivations)     currInput=layer.sampleHiddenGivenVisible(currInput).getSecond();
 else     currInput=layer.sampleHiddenGivenVisible(currInput).getSecond();
    activations.add(currInput);
  }
  if (getOutputLayer() != null) {
    getOutputLayer().setInput(currInput);
    activations.add(getOutputLayer().output(currInput));
  }
  return activations;
}
