{
  int vocabSize=numWords();
  table=Nd4j.create(new FloatBuffer(tableSize));
  double trainWordsPow=0.0;
  for (  String word : words()) {
    trainWordsPow+=Math.pow(wordFrequency(word),power);
  }
  int wordIdx=0;
  double d1=Math.pow(wordFrequency(wordAtIndex(wordIdx)),power) / trainWordsPow;
  for (int i=0; i < tableSize; i++) {
    table.putScalar(i,wordIdx);
    double mul=i * 1.0 / (double)tableSize;
    if (mul > d1) {
      wordIdx++;
      String wordAtIndex=wordAtIndex(wordIdx);
      if (wordAtIndex == null)       continue;
      d1+=Math.pow(wordFrequency(wordAtIndex),power) / trainWordsPow;
    }
    if (wordIdx >= vocabSize)     wordIdx=vocabSize - 1;
  }
}
