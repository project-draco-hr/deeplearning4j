{
  Double lastEntropy=null;
  BaseMultiLayerNetwork revert=clone();
  if (forceNumEpochs) {
    for (int i=0; i < epochs; i++) {
      backPropStep(lastEntropy,revert,lr,i);
      lastEntropy=negativeLogLikelihood();
    }
  }
 else {
    int count=0;
    while (backPropStep(lastEntropy,revert,lr,count)) {
      count++;
      lastEntropy=this.negativeLogLikelihood();
    }
  }
}
