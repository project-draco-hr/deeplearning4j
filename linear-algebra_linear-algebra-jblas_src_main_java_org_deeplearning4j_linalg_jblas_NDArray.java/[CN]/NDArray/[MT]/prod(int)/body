{
  if (dimension == Integer.MAX_VALUE) {
    return NDArray.scalar(reshape(new int[]{1,length}).prod());
  }
 else   if (isVector()) {
    return NDArray.scalar(prod());
  }
 else {
    int[] shape=ArrayUtil.removeIndex(shape(),dimension);
    final INDArray arr=NDArrays.create(new int[]{ArrayUtil.prod(shape)});
    final AtomicInteger i=new AtomicInteger(0);
    iterateOverDimension(dimension,new SliceOp(){
      @Override public void operate(      DimensionSlice nd){
        IComplexNDArray arr2=(IComplexNDArray)nd.getResult();
        arr.put(i.get(),arr2.prod(0));
        i.incrementAndGet();
      }
      /** 
 * Operates on an ndarray slice
 * @param nd the result to operate on
 */
      @Override public void operate(      INDArray nd){
        arr.put(i.get(),nd.prod(0));
        i.incrementAndGet();
      }
    }
,false);
    return arr.reshape(shape);
  }
}
