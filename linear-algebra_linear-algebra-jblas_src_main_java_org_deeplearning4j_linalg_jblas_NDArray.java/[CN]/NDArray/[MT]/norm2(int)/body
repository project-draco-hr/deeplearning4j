{
  if (isVector()) {
    return NDArray.scalar(norm2());
  }
 else {
    int[] shape=ArrayUtil.removeIndex(shape(),dimension);
    final INDArray arr=NDArrays.create(new int[]{ArrayUtil.prod(shape)});
    final AtomicInteger i=new AtomicInteger(0);
    iterateOverDimension(dimension,new SliceOp(){
      @Override public void operate(      DimensionSlice nd){
        INDArray arr2=(INDArray)nd.getResult();
        arr.put(i.get(),arr2.norm2(0));
        i.incrementAndGet();
      }
      /** 
 * Operates on an ndarray slice
 * @param nd the result to operate on
 */
      @Override public void operate(      INDArray nd){
        arr.put(i.get(),nd.norm2(0));
        i.incrementAndGet();
      }
    }
,false);
    return arr.reshape(shape);
  }
}
