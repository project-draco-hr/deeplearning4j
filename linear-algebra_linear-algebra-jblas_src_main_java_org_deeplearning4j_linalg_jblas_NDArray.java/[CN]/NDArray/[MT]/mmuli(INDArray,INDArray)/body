{
  NDArray otherArray=(NDArray)other;
  NDArray resultArray=(NDArray)result;
  if (other.isScalar()) {
    return muli(otherArray.scalar(),resultArray);
  }
  if (isScalar()) {
    return otherArray.muli(scalar(),resultArray);
  }
  if (result == this || result == other) {
    NDArray temp=new NDArray(resultArray.shape(),ArrayUtil.calcStridesFortran(resultArray.shape()));
    if (otherArray.columns() == 1) {
      NDArrayBlas.gemv(1.0,this,otherArray,0.0,temp);
    }
 else {
      NDArrayBlas.gemm(1.0,this,otherArray,0.0,temp);
    }
    NDArrayBlas.copy(temp,resultArray);
  }
 else {
    if (otherArray.columns() == 1)     NDArrayBlas.gemv(1.0,this,otherArray,0.0,resultArray);
 else     NDArrayBlas.gemm(1.0,this,otherArray,0.0,resultArray);
  }
  return resultArray;
}
