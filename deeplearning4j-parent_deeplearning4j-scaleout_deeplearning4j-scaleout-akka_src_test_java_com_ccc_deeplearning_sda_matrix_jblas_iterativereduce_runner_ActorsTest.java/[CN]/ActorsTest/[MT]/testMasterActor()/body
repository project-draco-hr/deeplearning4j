{
  final TestActorRef<BatchActor> ref1=TestActorRef.create(system,Props.create(new BatchActor.BatchActorFactory(new MnistDataSetIterator(1,1))),"testC");
  BatchActor ref2=ref1.underlyingActor();
  Conf c=new Conf();
  c.setPretrainEpochs(1);
  final TestActorRef<MasterActor> ref=TestActorRef.create(system,Props.create(new MasterActor.MasterActorFactory(c,ref1)),"testB");
  MasterActor master=ref.underlyingActor();
  assertEquals(c,master.getConf());
  assertEquals(0,master.getEpochsComplete());
  UpdateableImpl m=master.getMasterResults();
  master.onReceive(m);
  assertEquals(1,master.getEpochsComplete());
  assertEquals(1,ref2.getNumTimesReset());
  assertEquals(true,master.isDone());
}
