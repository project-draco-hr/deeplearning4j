{
  if (d.hasMaskArrays()) {
    INDArray[] features=new INDArray[]{d.getFeatures()};
    INDArray[] labels=new INDArray[]{d.getLabels()};
    INDArray[] fmask=(d.getFeaturesMaskArray() != null ? new INDArray[]{d.getFeaturesMaskArray()} : null);
    INDArray[] lmask=(d.getLabelsMaskArray() != null ? new INDArray[]{d.getLabelsMaskArray()} : null);
    return new org.nd4j.linalg.dataset.MultiDataSet(features,labels,fmask,lmask);
  }
 else {
    return new org.nd4j.linalg.dataset.MultiDataSet(d.getFeatures(),d.getLabels());
  }
}
