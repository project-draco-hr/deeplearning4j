{
  MnistDataFetcher fetcher=new MnistDataFetcher(true);
  fetcher.fetch(100);
  DataSet d=fetcher.next();
  log.info("Training on " + d.numExamples());
  StopWatch watch=new StopWatch();
  log.info("Data set " + d);
  StackedDenoisingAutoEncoder stackedDenoisingAutoEncoder=new StackedDenoisingAutoEncoder.Builder().hiddenLayerSizes(new int[]{500,250,100}).withMomentum(0.5).numberOfInputs(784).numberOfOutPuts(fetcher.totalOutcomes()).build();
  watch.start();
  stackedDenoisingAutoEncoder.pretrain(d.getFirst(),1,1e-2,300);
  stackedDenoisingAutoEncoder.finetune(d.getSecond(),1e-2,100);
  watch.stop();
  log.info("Took " + watch.getTime());
  Evaluation eval=new Evaluation();
  DoubleMatrix predict=stackedDenoisingAutoEncoder.output(d.getFirst());
  eval.eval(d.getSecond(),predict);
  log.info(eval.stats());
}
