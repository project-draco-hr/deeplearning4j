{
  Pair<DoubleMatrix,DoubleMatrix> pair=IrisUtils.loadIris();
  DoubleMatrix input=pair.getFirst();
  DoubleMatrix y=pair.getSecond();
  DenoisingAutoEncoderMatrix da=new DenoisingAutoEncoderMatrix(input,input.columns,1000,null,null,null,null);
  for (int i=0; i < input.rows; i++) {
    da.train(input.getRow(i),0.1,0.9);
  }
  log.info(da.W.transpose().toString());
  double p=1 - 0.3;
  for (int i=0; i < input.rows; i++) {
    DoubleMatrix tilde_x=da.get_corrupted_input(input.getRow(i),p);
    DoubleMatrix y2=da.get_hidden_values(tilde_x);
    DoubleMatrix z=da.get_reconstructed_input(y2);
    log.info(z.toString());
  }
}
