{
  RBM ret=new RBM.Builder().withHidden(hiddenUnit).withVisible(visibleUnit).useRegularization(isUseRegularization()).withOptmizationAlgo(getOptimizationAlgorithm()).withL2(getL2()).useAdaGrad(isUseAdaGrad()).normalizeByInputRows(isNormalizeByInputRows()).withLossFunction(getLossFunction()).withMomentum(getMomentum()).withSparsity(getSparsity()).withDistribution(getDist()).normalizeByInputRows(normalizeByInputRows).numberOfVisible(nVisible).numHidden(nHidden).withWeights(W).withDropOut(dropOut).withInput(input).withVisibleBias(vBias).withHBias(hBias).withDistribution(getDist()).withRandom(rng).renderWeights(getRenderWeightsEveryNEpochs()).fanIn(getFanIn()).build();
  ret.setGradientListeners(gradientListeners.get(index));
  return ret;
}
