{
  INDArray ret=Nd4j.randn(nIn,nOut);
switch (initScheme) {
case VI:
    double r=Math.sqrt(6) / Math.sqrt(nIn + nOut + 1);
  ret.muli(Nd4j.scalar(2)).muli(Nd4j.scalar(r)).subi(Nd4j.scalar(r));
return ret;
case DISTRIBUTION:
for (int i=0; i < ret.rows(); i++) {
ret.putRow(i,Nd4j.create(dist.sample(ret.columns())));
}
return ret;
}
throw new IllegalStateException("Illegal weight init value");
}
