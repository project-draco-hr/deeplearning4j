{
  if (isVector()) {
    return ComplexNDArray.scalar(sum().divi(length));
  }
 else {
    int[] shape=ArrayUtil.removeIndex(shape(),dimension);
    final IComplexNDArray arr=NDArrays.createComplex(new int[]{ArrayUtil.prod(shape)});
    final AtomicInteger i=new AtomicInteger(0);
    iterateOverDimension(dimension,new SliceOp(){
      @Override public void operate(      DimensionSlice nd){
        IComplexNDArray arr2=(IComplexNDArray)nd.getResult();
        arr.put(i.get(),arr2.prod(0));
        i.incrementAndGet();
      }
      /** 
 * Operates on an ndarray slice
 * @param nd the result to operate on
 */
      @Override public void operate(      INDArray nd){
      }
    }
,false);
    return arr.reshape(shape);
  }
}
