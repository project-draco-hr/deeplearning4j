{
  String paramName;
  INDArray paramVal, gradient2;
  GradientUpdater updater;
  preApply(layer,gradient,iteration);
  for (  Map.Entry<String,INDArray> gradientPair : gradient.gradientForVariable().entrySet()) {
    paramName=gradientPair.getKey();
    paramVal=gradientPair.getValue();
    LearningRateDecayPolicy decay=layer.conf().getLearningRateDecayPolicy();
    if (decay != null || decay != LearningRateDecayPolicy.None)     applyLrDecayPolicy(decay,layer,iteration,paramName);
    applyMomentumDecayPolicy(layer,iteration,paramName);
    updater=init(paramName,paramVal,layer);
    gradient2=updater.getGradient(paramVal,iteration);
    postApply(layer,gradient2,paramName,miniBatchSize);
    gradient.setGradientFor(paramName,gradient2);
  }
}
