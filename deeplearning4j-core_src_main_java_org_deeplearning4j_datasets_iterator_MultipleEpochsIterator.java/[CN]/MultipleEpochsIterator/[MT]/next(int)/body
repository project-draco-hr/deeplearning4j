{
  if (!iter.hasNext()) {
    passes++;
    log.info("Epoch " + passes + ", number of batches completed "+ batch);
    if (passes < numPasses) {
      batch=0;
      iter.reset();
    }
 else {
      return null;
    }
  }
  batch++;
  DataSet next=num == -1 ? iter.next() : iter.next(num);
  if (preProcessor != null)   preProcessor.preProcess(next);
  return next;
}
