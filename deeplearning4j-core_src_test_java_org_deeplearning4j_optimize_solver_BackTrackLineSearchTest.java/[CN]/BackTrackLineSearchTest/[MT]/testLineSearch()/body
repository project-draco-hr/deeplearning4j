{
  DataSet data=new IrisDataSetIterator(1,1).next();
  data.normalizeZeroMeanZeroUnitVariance();
  OutputLayer layer=getIrisLogisticLayerConfig("softmax",10);
  layer.setInput(data.getFeatureMatrix());
  layer.setLabels(data.getLabels());
  BackTrackLineSearch lineSearch=new BackTrackLineSearch(layer,layer.getOptimizer());
  double step=lineSearch.optimize(1.0,layer.params(),layer.gradient().gradient(),layer.gradient().gradient().dup());
  assertEquals(0.0,step,1e-1);
}
