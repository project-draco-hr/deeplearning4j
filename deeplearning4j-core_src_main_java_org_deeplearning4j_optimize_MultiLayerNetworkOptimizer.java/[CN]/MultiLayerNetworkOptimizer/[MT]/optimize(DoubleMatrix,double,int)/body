{
  network.getOutputLayer().setLabels(labels);
  if (!network.isForceNumEpochs()) {
    network.getOutputLayer().trainTillConvergence(labels,lr,epochs,null);
    if (network.isShouldBackProp())     network.backProp(lr,epochs);
  }
 else {
    log.info("Training for " + epochs + " epochs");
    for (int i=0; i < epochs; i++) {
      network.getOutputLayer().train(lr);
      if (i % network.getResetAdaGradIterations() == 0)       network.getOutputLayer().getAdaGrad().historicalGradient=null;
      log.info("Error on iteration " + i + " is  "+ network.score());
    }
    if (network.isShouldBackProp())     network.backProp(lr,epochs);
  }
}
