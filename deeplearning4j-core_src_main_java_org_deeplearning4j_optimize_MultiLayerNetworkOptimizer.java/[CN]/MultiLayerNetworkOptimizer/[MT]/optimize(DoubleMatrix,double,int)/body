{
  network.getLogLayer().setLabels(labels);
  log.info("Starting negative log likelihood of model " + this.network.negativeLogLikelihood());
  DoubleMatrix train=sampleHiddenGivenVisible();
  if (!network.isForceNumEpochs()) {
    network.getLogLayer().trainTillConvergence(train,labels,lr,epochs);
    if (network.isShouldBackProp())     network.backProp(lr,epochs);
  }
 else {
    log.info("Training for " + epochs + " epochs");
    for (int i=0; i < epochs; i++) {
      network.getLogLayer().train(train,labels,lr);
    }
    if (network.isShouldBackProp())     network.backProp(lr,epochs);
  }
}
