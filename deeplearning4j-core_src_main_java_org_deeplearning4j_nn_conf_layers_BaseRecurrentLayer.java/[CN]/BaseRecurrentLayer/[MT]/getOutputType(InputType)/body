{
  if (inputType == null || inputType.getType() != InputType.Type.RNN || ((InputType.InputTypeRecurrent)inputType).getSize() <= 0) {
    throw new IllegalStateException("Invalid input for RNN layer: expect RNN input type with size > 0. Got: " + inputType);
  }
  return InputType.recurrent(nOut);
}
