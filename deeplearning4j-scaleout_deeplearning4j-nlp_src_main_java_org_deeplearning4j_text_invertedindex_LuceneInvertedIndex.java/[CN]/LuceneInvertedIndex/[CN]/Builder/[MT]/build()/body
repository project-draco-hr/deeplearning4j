{
  LuceneInvertedIndex<T> ret;
  if (indexDir != null) {
    ret=new LuceneInvertedIndex<>(vocabCache,cache,indexDir.getAbsolutePath());
  }
 else   ret=new LuceneInvertedIndex<>(vocabCache);
  try {
    ret.batchSize=batchSize;
    if (dir != null)     ret.dir=dir;
    ret.miniBatch=miniBatch;
    if (reader != null)     ret.reader=reader;
    if (analyzer != null)     ret.analyzer=analyzer;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  return ret;
}
