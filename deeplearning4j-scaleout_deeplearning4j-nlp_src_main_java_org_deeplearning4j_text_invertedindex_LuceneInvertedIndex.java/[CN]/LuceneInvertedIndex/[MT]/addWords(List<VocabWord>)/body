{
  if (!miniBatch)   return;
  for (  VocabWord word : words) {
    if (sample > 0) {
      double ran=(Math.sqrt(word.getWordFrequency() / (sample * numDocuments())) + 1) * (sample * numDocuments()) / word.getWordFrequency();
      if (ran < (nextRandom.get() & 0xFFFF) / (double)65536) {
        continue;
      }
      currMiniBatch.add(word);
    }
 else {
      currMiniBatch.add(word);
      if (currMiniBatch.size() >= batchSize) {
        miniBatches.add(new ArrayList<>(currMiniBatch));
        currMiniBatch.clear();
      }
    }
  }
}
