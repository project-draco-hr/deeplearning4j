{
  if (type != null && type.equals("worker")) {
    log.info("Initializing conf from zookeeper at " + host);
    ZookeeperConfigurationRetriever retriever=new ZookeeperConfigurationRetriever(host,2181,"master");
    Conf conf=retriever.retrieve();
    String address=conf.getMasterUrl();
    log.info("Creating hazel cast state tracker... " + conf.getStateTrackerConnectionString());
    HazelCastStateTracker stateTracker=new HazelCastStateTracker(conf.getStateTrackerConnectionString());
    log.info("Creating hazel cast via worker " + stateTracker.connectionString());
    runner=new ActorNetworkRunner(type,address);
    runner.setMasterHost(host);
    runner.setStateTracker(stateTracker);
    runner.setup(conf);
    retriever.close();
  }
 else {
    Conf conf=new Conf();
    getDataSet();
    conf.setMultiLayerClazz((Class<? extends BaseMultiLayerNetwork>)Class.forName(getClassForAlgorithm()));
    conf.setLayerSizes(hiddenLayerSizes);
    conf.setSplit(10);
    conf.getConf().setnIn(iter.inputColumns());
    conf.getConf().setnOut(iter.totalOutcomes());
    conf.getConf().setPretrainEpochs(pretrainEpochs);
    conf.getConf().setFinetuneEpochs(finetuneEpochs);
    conf.getConf().setSeed(rngSeed);
    conf.getConf().setPretrainLearningRate(pretrainLearningRate);
    conf.getConf().setUseAdaGrad(useAdaGrad);
    conf.getConf().setCorruptionLevel(corruptionLevel);
    conf.setSplit(split);
    conf.getConf().setK(k);
    conf.getConf().setFinetuneLearningRate(finetuneLearningRate);
    conf.getConf().setPretrainEpochs(pretrainEpochs);
    conf.getConf().setPretrainLearningRate(pretrainLearningRate);
    runner=new ActorNetworkRunner("master",iter);
    runner.setStateTrackerPort(stateTrackerPort);
    runner.setup(conf);
  }
}
