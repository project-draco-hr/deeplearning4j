{
  int columns=isColumnOp(op) ? arr.columns() : arr.rows();
  int[] shape={arr.slices(),columns};
  ComplexNDArray ret=new ComplexNDArray(shape);
  for (int i=0; i < arr.slices(); i++) {
switch (op) {
case COLUMN_SUM:
      ret.putSlice(i,arr.slice(i).columnSums());
    break;
case COLUMN_MEAN:
  ret.putSlice(i,arr.slice(i).columnMeans());
break;
case ROW_SUM:
ret.putSlice(i,arr.slice(i).rowSums());
break;
case ROW_MEAN:
ret.putSlice(i,arr.slice(i).rowMeans());
break;
}
}
return ret;
}
