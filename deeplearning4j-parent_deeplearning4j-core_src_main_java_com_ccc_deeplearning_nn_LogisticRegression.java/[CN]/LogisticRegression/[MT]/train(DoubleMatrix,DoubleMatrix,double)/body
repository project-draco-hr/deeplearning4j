{
  ensureValidOutcomeMatrix(y);
  if (x.rows != y.rows) {
    throw new IllegalArgumentException("How does this happen?");
  }
  this.input=x;
  this.labels=y;
  DoubleMatrix p_y_given_x=softmax(x.mmul(W).addRowVector(b));
  DoubleMatrix dy=y.sub(p_y_given_x);
  W=W.add(x.transpose().mmul(dy).mul(lr));
  b=b.add(dy.columnMeans().mul(lr));
}
