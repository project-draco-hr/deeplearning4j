{
  DoubleMatrix sigAct=softmax(input.mmul(W).addRowVector(b));
  if (useRegularization) {
    double reg=(2 / l2) * MatrixFunctions.pow(this.W,2).sum();
    return -labels.mul(log(sigAct)).add(oneMinus(labels).mul(log(oneMinus(sigAct)))).columnSums().mean() + reg;
  }
  return -labels.mul(log(sigAct)).add(oneMinus(labels).mul(log(oneMinus(sigAct)))).columnSums().mean();
}
