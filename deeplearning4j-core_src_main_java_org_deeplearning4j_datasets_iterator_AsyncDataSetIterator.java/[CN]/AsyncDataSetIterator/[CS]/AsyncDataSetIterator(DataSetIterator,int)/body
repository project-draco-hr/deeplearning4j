{
  if (queueSize <= 0)   throw new IllegalArgumentException("Queue size must be > 0");
  this.baseIterator=baseIterator;
  this.baseIterator.reset();
  blockingQueue=new LinkedBlockingDeque<>(queueSize);
  runnable=new IteratorRunnable(baseIterator.hasNext());
  thread=new Thread(runnable);
  Integer deviceId=Nd4j.getAffinityManager().getDeviceForCurrentThread();
  Nd4j.getAffinityManager().attachThreadToDevice(thread,deviceId);
  thread.setDaemon(true);
  thread.start();
}
