{
  super(preProcessor);
  this.path=path;
  File f=new File(path);
  if (f.isFile()) {
    if (f.getTotalSpace() >= 1024) {
      if (corpusBreaker == null)       this.corpusBreaker=new FileCorpusBreaker(f,1024,1000000);
 else       this.corpusBreaker=corpusBreaker;
      try {
        URI[] locations=corpusBreaker.corporaLocations();
        File parentDir=new File(locations[0]).getParentFile();
        this.reader=FilesCollectionReader.getCollectionReader(parentDir.getAbsolutePath());
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
 else {
      try {
        this.reader=FilesCollectionReader.getCollectionReader(path);
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
 else {
    try {
      this.reader=FilesCollectionReader.getCollectionReader(path);
    }
 catch (    ResourceInitializationException e) {
      throw new RuntimeException(e);
    }
  }
  this.resource=resource;
}
