{
  TransactionContext context=beginTransaction();
  TransactionalList<WorkerState> availableWorkers=context.getList(AVAILABLE_WORKERS);
  TransactionalMap<String,WorkerState> workers=context.getMap(CURRENT_WORKERS);
  WorkerState w=workers.get(id);
  w.setAvailable(true);
  workers.put(w.getWorkerId(),w);
  if (!this.availableWorkers.contains(workers.get(id)))   availableWorkers.add(workers.get(id));
  availableWorkers.add(workers.get(id));
  h.getAtomicReference("job-" + id).destroy();
  IAtomicReference<WorkerState> workerRef=h.getAtomicReference(id);
  workerRef.set(w);
  context.commitTransaction();
}
