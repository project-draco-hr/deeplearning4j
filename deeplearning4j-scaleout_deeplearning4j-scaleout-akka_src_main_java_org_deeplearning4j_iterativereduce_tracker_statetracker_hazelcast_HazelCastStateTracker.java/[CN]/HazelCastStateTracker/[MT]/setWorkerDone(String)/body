{
  TransactionContext context=beginTransaction();
  TransactionalQueue<WorkerState> availableWorkers=context.getQueue(AVAILABLE_WORKERS);
  TransactionalMap<String,WorkerState> workers=context.getMap(CURRENT_WORKERS);
  WorkerState w=workers.get(id);
  w.setAvailable(true);
  workers.put(w.getWorkerId(),w);
  availableWorkers.offer(workers.get(id));
  context.commitTransaction();
}
