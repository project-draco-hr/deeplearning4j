{
  DoubleMatrix params=network.params();
  double score=network.score(p.add(params));
  int i=chs.size() - 2;
  for (; i > 0; i--) {
    double score2=network.score(params.add(chs.get(i)));
    if (score2 < score) {
      i++;
      break;
    }
    score=score2;
  }
  if (chs.isEmpty()) {
    log.warn("No chs; exiting with old ch value");
  }
  DoubleMatrix ret=!chs.isEmpty() && i >= 0 ? chs.get(i) : ch;
  return new Pair<>(ret,score);
}
