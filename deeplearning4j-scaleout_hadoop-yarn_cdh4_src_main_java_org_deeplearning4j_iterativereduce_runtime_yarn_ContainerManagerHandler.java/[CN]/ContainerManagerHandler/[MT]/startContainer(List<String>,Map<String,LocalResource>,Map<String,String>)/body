{
  if (containerManager == null)   throw new IllegalStateException("Cannot start a continer before connecting to the container manager!");
  ContainerLaunchContext ctx=Records.newRecord(ContainerLaunchContext.class);
  ctx.setContainerId(container.getId());
  ctx.setResource(container.getResource());
  ctx.setLocalResources(localResources);
  ctx.setCommands(commands);
  ctx.setUser(UserGroupInformation.getCurrentUser().getShortUserName());
  ctx.setEnvironment(env);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Using ContainerLaunchContext with" + ", containerId=" + ctx.getContainerId() + ", memory="+ ctx.getResource().getMemory()+ ", localResources="+ ctx.getLocalResources().toString()+ ", commands="+ ctx.getCommands().toString()+ ", env="+ ctx.getEnvironment().toString());
  }
  StartContainerRequest request=Records.newRecord(StartContainerRequest.class);
  request.setContainerLaunchContext(ctx);
  LOG.info("Starting container, containerId=" + container.getId().toString() + ", host="+ container.getNodeId().getHost()+ ", http="+ container.getNodeHttpAddress());
  return containerManager.startContainer(request);
}
