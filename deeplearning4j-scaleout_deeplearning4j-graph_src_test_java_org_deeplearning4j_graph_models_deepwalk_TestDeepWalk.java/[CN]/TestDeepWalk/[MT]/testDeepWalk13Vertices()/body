{
  ClassPathResource cpr=new ClassPathResource("graph13.txt");
  Graph<String,String> graph=GraphLoader.loadUndirectedGraphEdgeListFile(cpr.getFile().getAbsolutePath(),13,",");
  System.out.println(graph);
  Nd4j.getRandom().setSeed(12345);
  DeepWalk<String,String> deepWalk=new DeepWalk.Builder<String,String>().learningRate(0.001).vectorSize(15).windowSize(2).seed(12345).build();
  for (int i=0; i < 5000; i++) {
    deepWalk.fit(graph,10);
  }
  for (int i=0; i < 13; i++)   System.out.println(Arrays.toString(deepWalk.getVertexVector(i).dup().data().asFloat()));
  InMemoryGraphLookupTable table=((InMemoryGraphLookupTable)deepWalk.lookupTable());
  for (int i=0; i < 13; i++) {
    for (int j=i; j < 13; j++) {
      System.out.println(i + "\t" + j+ "\t"+ deepWalk.similarity(i,j)+ "\t"+ table.calculateProb(i,j));
    }
  }
}
