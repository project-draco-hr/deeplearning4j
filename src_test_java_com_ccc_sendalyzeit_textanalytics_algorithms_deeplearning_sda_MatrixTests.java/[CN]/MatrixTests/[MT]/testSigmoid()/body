{
  double[][] test3=new double[][]{{-7.25067769,-6.19433149,-17.0033974,8.98745366,14.30550463,-13.21522886,14.17218361,-7.12945766,-17.05297072,-12.41255303,12.29899021,-1.64831235,-16.1645499,-12.048707,13.65494118},{-10.01312476,-6.3479751,-14.79441769,9.71058066,14.16978231,-11.35349077,13.98626908,-9.87793885,-14.86681377,-10.63027895,12.51909286,-5.37358619,-14.03857187,-10.33264322,13.60084389},{-7.91751591,5.29727563,-13.82297759,5.88698006,11.05804915,-10.92276038,11.10324376,-8.70090769,-13.95534588,-10.04025558,8.90037784,6.63394887,-13.1934306,-9.952526,10.20579893},{-9.85383166,-9.07468389,-13.5015295,7.74401962,11.53662316,-10.28551473,11.39881506,6.82031733,-13.4642754,-9.82629144,10.11866638,-1.39349188,-12.79905781,-9.53424876,11.26982471},{6.87892443,-7.57445053,-13.90814413,7.41895199,11.49434131,-10.68518588,11.31421109,-8.68628835,-13.98394422,-10.03415764,10.03113786,-4.99222139,-13.21321936,-9.79233842,11.03724832},{-8.79680369,-7.81131271,13.8064215,-12.59755439,-17.46328754,11.04326085,-17.23322537,-9.99834351,13.99920422,9.96952428,-15.6277948,-8.88296202,13.08234881,-1.24798963,-16.91603047},{-10.72559843,-9.6092878,12.80337338,-10.95866988,-15.2697348,10.48260563,-15.02124257,-11.83601183,13.0170038,9.53414116,-13.57911129,-7.41629428,12.27125175,3.83954914,-14.75670803},{-11.24813886,6.49657626,11.53266167,-9.8278634,-14.0100366,8.91426274,-13.781709,-12.58770582,11.51897351,8.61219964,-12.46788713,-6.92526494,10.97787092,-2.24810024,-13.42118144},{-10.44328193,-9.67362559,11.09602833,-10.24368256,-14.04517369,8.93017129,-13.85074609,5.34883639,11.20418092,7.65861809,-12.55124021,-7.54229739,10.49256719,-2.57940985,-13.7716459},{6.16880702,-9.6668661,11.2113136,-10.00090068,-14.23978852,9.05873469,-14.06291841,-12.01927178,11.42514761,8.20023202,-12.72838934,-7.31605095,10.46972255,-2.28181977,-13.7336314}};
  double[][] testOutput=new double[][]{{7.09189963e-04,2.03681009e-03,4.12589637e-08,9.99875048e-01,9.99999387e-01,1.82262885e-06,9.99999300e-01,8.00512435e-04,3.92634897e-08,4.06719455e-06,9.99995444e-01,1.61337171e-01,9.54608141e-08,5.85208324e-06,9.99998826e-01},{4.48059519e-05,1.74722956e-03,3.75721348e-07,9.99939365e-01,9.99999298e-01,1.17283391e-05,9.99999157e-01,5.12912623e-05,3.49481880e-07,2.41723021e-05,9.99996344e-01,4.61606375e-03,8.00065155e-07,3.25518689e-05,9.99998761e-01},{3.64173502e-04,9.95019716e-01,9.92559791e-07,9.97232336e-01,9.99984240e-01,1.80425369e-05,9.99984937e-01,1.66406975e-04,8.69500659e-07,4.36067246e-05,9.99863681e-01,9.98686767e-01,1.86279508e-06,4.76049596e-05,9.99963046e-01},{5.25427097e-05,1.14515724e-04,1.36886193e-06,9.99566861e-01,9.99990234e-01,3.41226607e-05,9.99988791e-01,9.98909815e-01,1.42081938e-06,5.40097783e-05,9.99959682e-01,1.98850883e-01,2.76336732e-06,7.23264187e-05,9.99987248e-01},{9.98971808e-01,5.13138994e-04,9.11526617e-07,9.99400582e-01,9.99989813e-01,2.28808838e-05,9.99987802e-01,1.68857191e-04,8.44986601e-07,4.38734366e-05,9.99955994e-01,6.74476248e-03,1.82629509e-06,5.58749560e-05,9.99983909e-01},{1.51192773e-04,4.04961824e-04,9.99998991e-01,3.38026053e-06,2.60489711e-08,9.99984006e-01,3.27872735e-08,4.54731288e-05,9.99999168e-01,9.99953197e-01,1.63280712e-07,1.38713383e-04,9.99997918e-01,2.23048338e-01,4.50257850e-08},{2.19746640e-05,6.70980950e-05,9.99997249e-01,1.74061444e-05,2.33581443e-07,9.99971981e-01,2.99472613e-07,7.23906089e-06,9.99997778e-01,9.99927666e-01,1.26667835e-06,6.01012110e-04,9.99995316e-01,9.78949364e-01,3.90160196e-07},{1.30313587e-05,9.98493677e-01,9.99990196e-01,5.39249482e-05,8.23224065e-07,9.99865561e-01,1.03437825e-06,3.41371561e-06,9.99990060e-01,9.99818160e-01,3.84825416e-06,9.81678106e-04,9.99982925e-01,9.55134602e-02,1.48338648e-06},{2.91425554e-05,6.29173558e-05,9.99984828e-01,3.55803107e-05,7.94800672e-07,9.99867682e-01,9.65377084e-07,9.95268811e-01,9.99986383e-01,9.99528263e-01,3.54049593e-06,5.29897258e-04,9.99972259e-01,7.04753810e-02,1.04483984e-06},{9.97910642e-01,6.33440584e-05,9.99986480e-01,4.53570000e-05,6.54241572e-07,9.99883643e-01,7.80821557e-07,6.02689983e-06,9.99989083e-01,9.99725486e-01,2.96571531e-06,6.64340648e-04,9.99971618e-01,9.26398739e-02,1.08532347e-06}};
  DoubleMatrix input=new DoubleMatrix(test3);
  DoubleMatrix sigmoid=new DoubleMatrix(testOutput);
  log.info(sigmoid.toString());
  assertEquals(true,MatrixUtil.sigmoid(input).distance2(sigmoid) < 0.01);
}
