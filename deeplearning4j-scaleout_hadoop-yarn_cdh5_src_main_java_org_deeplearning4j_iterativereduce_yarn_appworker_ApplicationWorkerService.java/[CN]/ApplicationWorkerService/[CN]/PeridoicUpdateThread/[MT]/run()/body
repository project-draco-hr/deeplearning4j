{
  Thread.currentThread().setName("Periodic worker heartbeat thread");
  while (true) {
    LOG.debug("Attemping to acquire state lock");
synchronized (currentState) {
      if (WorkerState.RUNNING == currentState) {
        LOG.debug("Worker is running, sending a progress report");
        try {
          masterService.progress(workerId,createProgressReport());
        }
 catch (        AvroRemoteException ex) {
          LOG.warn("Encountered an exception while heartbeating to master",ex);
        }
      }
    }
    try {
      LOG.debug("Thread " + Thread.currentThread().getName() + " is going to sleep for "+ statusSleepTime);
      Thread.sleep(statusSleepTime);
    }
 catch (    InterruptedException ex) {
      LOG.warn("Interrupted while sleeping on progress report");
      return;
    }
  }
}
