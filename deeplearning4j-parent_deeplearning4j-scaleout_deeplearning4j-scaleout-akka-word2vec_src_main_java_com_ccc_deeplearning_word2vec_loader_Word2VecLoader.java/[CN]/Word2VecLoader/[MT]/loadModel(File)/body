{
  log.info("Loading model from " + file.getAbsolutePath());
  Word2Vec ret=new Word2Vec();
  try (DataInputStream dis=new DataInputStream(new BufferedInputStream(new FileInputStream(file)))){
    int vocabSize=dis.readInt();
    int layerSize=dis.readInt();
    ret.setLayerSize(layerSize);
    for (int i=0; i < vocabSize; i++) {
      String word=dis.readUTF();
      ret.getWordIndex().add(word);
      ret.getVocab().put(word,new VocabWord().read(dis,layerSize));
    }
    ret.setSyn0(DoubleMatrix.zeros(vocabSize,layerSize));
    ret.setSyn1(DoubleMatrix.zeros(vocabSize,layerSize));
    ret.getSyn0().in(dis);
    ret.getSyn1().in(dis);
    dis.close();
  }
 catch (  IOException e) {
    log.error("Unable to read file for loading model",e);
  }
  return ret;
}
