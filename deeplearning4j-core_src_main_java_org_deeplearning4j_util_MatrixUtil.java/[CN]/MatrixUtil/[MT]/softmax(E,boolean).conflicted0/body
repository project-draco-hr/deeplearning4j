{
  if (row) {
    FloatMatrix max=input.rowMaxs();
    FloatMatrix diff=MatrixFunctions.exp(input.subColumnVector(max));
    diff.diviColumnVector(diff.rowSums());
    return createBasedOn(diff,input);
  }
 else {
    FloatMatrix max=input.columnMaxs();
    FloatMatrix diff=MatrixFunctions.exp(input.subRowVector(max));
    diff.diviRowVector(diff.columnSums());
    return createBasedOn(diff,input);
  }
}
