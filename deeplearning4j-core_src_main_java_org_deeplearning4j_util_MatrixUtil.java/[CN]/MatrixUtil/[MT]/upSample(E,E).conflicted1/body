{
  FloatMatrix shape=size(d);
  FloatMatrix idx=new FloatMatrix(shape.length,1);
  for (int i=0; i < shape.length; i++) {
    FloatMatrix tmp=FloatMatrix.zeros((int)shape.get(i) * (int)scale.get(i),1);
    int[] indices=indicesCustomRange(0,(int)scale.get(i),(int)scale.get(i) * (int)shape.get(i));
    tmp.put(indices,1.0f);
    idx.put(i,cumsum(tmp).sum());
  }
  return createBasedOn(idx,d);
}
