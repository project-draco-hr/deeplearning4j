{
  DoubleMatrix shape=size(d);
  DoubleMatrix idx=new DoubleMatrix(shape.length,1);
  for (int i=0; i < shape.length; i++) {
    DoubleMatrix tmp=DoubleMatrix.zeros((int)shape.get(i) * (int)scale.get(i),1);
    Range r1=RangeUtils.interval(0,(int)scale.get(i));
    Range r2=RangeUtils.interval((int)shape.get(i),(int)scale.get(i));
    tmp.put(toIndices(r1),toIndices(r2),1.0);
    idx.put(i,cumsum(tmp).sum());
  }
  return idx;
}
