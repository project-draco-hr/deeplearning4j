{
  INDArray idx=NDArrays.create(d.shape().length,1);
  for (int i=0; i < d.shape().length; i++) {
    INDArray tmp=NDArrays.zeros(d.size(i) * (int)scale.getScalar(i).element(),1);
    int[] indices=ArrayUtil.range(0,(int)scale.getScalar(i).element() * d.size(i),(int)scale.getScalar(i).element());
    tmp.putScalar(indices,1.0f);
    idx.put(i,tmp.cumsum(Integer.MAX_VALUE).sum(Integer.MAX_VALUE));
  }
  return idx;
}
