{
  INDArray input=pair.getSecond();
  if (input.shape().length == 4)   return pair;
  if (input.columns() != rows * cols)   throw new IllegalArgumentException("Output columns must be equal to rows " + rows + " x columns "+ cols+ " but was instead "+ Arrays.toString(input.shape()));
  return new Pair<>(pair.getFirst(),input.reshape(input.size(0),channels,rows,cols));
}
