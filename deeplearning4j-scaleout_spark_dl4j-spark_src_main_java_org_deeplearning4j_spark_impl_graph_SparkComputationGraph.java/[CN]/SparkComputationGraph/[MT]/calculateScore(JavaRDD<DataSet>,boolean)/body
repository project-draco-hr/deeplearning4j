{
  JavaDoubleRDD scores=data.mapPartitionsToDouble(new ScoreFlatMapFunctionCGDataSet(conf.toJson(),sc.broadcast(network.params(false))));
  if (average)   return scores.mean();
  return scores.sum();
}
