{
  Layer layer=getContainedConfig();
  INDArray input=getContainedData();
  INDArray col=getContainedCol();
  INDArray epsilon=Nd4j.ones(1,2,4,4);
  INDArray expectedWeightGradient=Nd4j.create(new double[]{-1440.,-1440.,-1984.,-1984.,-1440.,-1440.,-1984.,-1984.},new int[]{2,1,2,2});
  INDArray expectedBiasGradient=Nd4j.create(new double[]{-544.,-544.},new int[]{2});
  INDArray expectedEpsilon=Nd4j.create(new double[]{-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-12.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.,-56.},new int[]{1,1,8,8});
  layer.setInput(input);
  org.deeplearning4j.nn.layers.convolution.ConvolutionLayer layer2=(org.deeplearning4j.nn.layers.convolution.ConvolutionLayer)layer;
  layer2.setCol(col);
  Pair<Gradient,INDArray> pair=layer2.backpropGradient(epsilon);
  assertArrayEquals(expectedEpsilon.shape(),pair.getSecond().shape());
  assertArrayEquals(expectedWeightGradient.shape(),pair.getFirst().getGradientFor("W").shape());
  assertArrayEquals(expectedBiasGradient.shape(),pair.getFirst().getGradientFor("b").shape());
  assertEquals(expectedEpsilon.toString(),pair.getSecond().toString());
  assertEquals(expectedWeightGradient.toString(),pair.getFirst().getGradientFor("W").toString());
  assertEquals(expectedBiasGradient.toString(),pair.getFirst().getGradientFor("b").toString());
}
