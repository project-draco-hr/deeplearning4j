{
  if (conf.getnIn() < 1)   throw new IllegalStateException("Number of visible can not be less than 1");
  if (conf.getnOut() < 1)   throw new IllegalStateException("Number of hidden can not be less than 1");
  int nVisible=conf.getnIn();
  int nHidden=conf.getnOut();
  if (this.W == null) {
    this.W=NDArrays.zeros(nVisible,nHidden);
    for (int i=0; i < this.W.rows(); i++)     this.W.putRow(i,NDArrays.create(conf.getDist().sample(this.W.columns())));
  }
  this.wAdaGrad=new AdaGrad(this.W.rows(),this.W.columns());
  if (this.hBias == null) {
    this.hBias=NDArrays.zeros(nHidden);
  }
  this.hBiasAdaGrad=new AdaGrad(hBias.rows(),hBias.columns());
  if (this.vBias == null) {
    if (this.input != null)     this.vBias=NDArrays.zeros(nVisible);
 else     this.vBias=NDArrays.zeros(nVisible);
  }
  this.vBiasAdaGrad=new AdaGrad(vBias.rows(),vBias.columns());
}
