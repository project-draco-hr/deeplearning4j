{
  if (conf.getnIn() < 1)   throw new IllegalStateException("Number of visible can not be less than 1");
  if (conf.getnOut() < 1)   throw new IllegalStateException("Number of hidden can not be less than 1");
  int nVisible=conf.getnIn();
  int nHidden=conf.getnOut();
  if (this.W == null) {
    this.W=Nd4j.zeros(nVisible,nHidden);
    for (int i=0; i < this.W.rows(); i++)     this.W.putRow(i,Nd4j.create(conf.getDist().sample(this.W.columns())));
  }
  if (this.hBias == null) {
    this.hBias=Nd4j.zeros(nHidden);
  }
  if (this.vBias == null) {
    if (this.input != null)     this.vBias=Nd4j.zeros(nVisible);
 else     this.vBias=Nd4j.zeros(nVisible);
  }
}
