{
  if (this.useRegularization) {
    W.addi(network.getW().mini(W).div(batchSize));
    hBias.addi(network.gethBias().subi(hBias).divi(batchSize));
    vBias.addi(network.getvBias().subi(vBias).divi(batchSize));
  }
 else {
    W.addi(network.getW().mini(W));
    hBias.addi(network.gethBias().subi(hBias));
    vBias.addi(network.getvBias().subi(vBias));
  }
}
