{
  INDArray squaredDiff=pow(reconstruct(input).sub(input),2);
  float loss=(float)squaredDiff.sum(Integer.MAX_VALUE).element() / input.rows();
  if (this.useRegularization) {
    loss+=0.5 * l2 * (float)pow(W,2).sum(Integer.MAX_VALUE).element();
  }
  return loss;
}
