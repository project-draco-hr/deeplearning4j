{
  INDArray squaredDiff=pow(transform(input).sub(input),2);
  float loss=(float)squaredDiff.sum(Integer.MAX_VALUE).element() / input.rows();
  if (conf.isUseRegularization()) {
    loss+=0.5 * conf.getL2() * (float)pow(W,2).sum(Integer.MAX_VALUE).element();
  }
  return loss;
}
