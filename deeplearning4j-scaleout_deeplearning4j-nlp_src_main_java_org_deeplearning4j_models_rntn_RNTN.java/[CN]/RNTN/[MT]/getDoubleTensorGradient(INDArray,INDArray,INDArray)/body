{
  int size=deltaFull.length();
  INDArray Wt_df=Nd4j.create(size * 2,size * 2,size);
  INDArray fullVector=Nd4j.concat(0,leftVector,rightVector);
  for (int slice=0; slice < size; ++slice) {
    Nd4j.getBlasWrapper().level1().scal(fullVector.length(),deltaFull.getDouble(slice),fullVector);
    Wt_df.putSlice(slice,fullVector.mmul(fullVector.transpose()));
  }
  return Wt_df;
}
