{
  this.trainingTrees=trainingBatch;
  for (  Tree t : trainingBatch) {
    forwardPropagateTree(t);
    INDArray params=getParameters();
    INDArray gradient=getValueGradient();
    if (params.length() != gradient.length())     throw new IllegalStateException("Params not equal to gradient!");
    setParameters(params.subi(gradient));
  }
}
