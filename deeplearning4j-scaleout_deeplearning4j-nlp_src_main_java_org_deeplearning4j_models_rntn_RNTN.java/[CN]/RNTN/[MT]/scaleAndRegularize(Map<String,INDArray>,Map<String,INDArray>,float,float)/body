{
  float cost=0.0f;
  for (  Map.Entry<String,INDArray> entry : currentMatrices.entrySet()) {
    INDArray D=derivatives.get(entry.getKey());
    D=Nd4j.getBlasWrapper().scal(scale,D).add(Nd4j.getBlasWrapper().scal(regCost,entry.getValue()));
    derivatives.put(entry.getKey(),D);
    cost+=(float)entry.getValue().mul(entry.getValue()).sum(Integer.MAX_VALUE).element() * regCost / 2.0f;
  }
  return cost;
}
