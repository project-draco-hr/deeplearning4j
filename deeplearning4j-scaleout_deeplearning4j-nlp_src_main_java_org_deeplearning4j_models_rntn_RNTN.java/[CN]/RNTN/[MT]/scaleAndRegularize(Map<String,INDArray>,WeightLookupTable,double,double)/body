{
  double cost=0.0f;
  for (  String s : vocabCache.words()) {
    INDArray D=derivatives.get(s);
    INDArray vector=currentMatrices.vector(s);
    D=Nd4j.getBlasWrapper().scal(scale,D).addi(Nd4j.getBlasWrapper().scal(regCost,vector));
    derivatives.put(s,D);
    cost+=vector.mul(vector).sum(Integer.MAX_VALUE).getDouble(0) * regCost / 2.0f;
  }
  return cost;
}
