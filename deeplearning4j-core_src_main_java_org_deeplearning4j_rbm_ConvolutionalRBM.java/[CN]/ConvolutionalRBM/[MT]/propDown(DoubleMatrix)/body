{
  Tensor h1=(Tensor)h;
  for (int i=0; i < numFilters; i++) {
    DoubleMatrix conv=conv2d(h1.getSlice(i),W.getSlice(i),FULL);
    visI.setSlice(i,conv);
  }
  DoubleMatrix I=visI.sliceElementSums().add(hBias);
  if (visibleType == VisibleUnit.BINARY)   I=sigmoid(I);
  Tensor ret=new Tensor(I);
  this.eVis=ret;
  return ret;
}
