{
  FourDTensor h1=(FourDTensor)h;
  for (int i=0; i < numFilters[0]; i++) {
    for (int j=0; j < numFilters[1]; j++) {
      visI.put(j,i,sigmoid(conv2d(h1.getSlice(i),W.getSlice(i),FULL)));
    }
  }
  DoubleMatrix I=visI.sliceElementSums().add(vBias);
  if (visibleType == VisibleUnit.BINARY)   I=sigmoid(I);
  FourDTensor ret=new FourDTensor(I);
  this.eVis=ret;
  return ret;
}
