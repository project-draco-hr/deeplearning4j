{
  for (int i=0; i < numFilters; i++) {
    DoubleMatrix reversedSlice=MatrixUtil.reverse(W.getSlice(i));
    DoubleMatrix slice=Convolution.conv2d(v,reversedSlice,Convolution.Type.VALID).add(hBias.get(i));
    hidI.setSlice(i,slice);
  }
  Tensor expHidI=hidI.exp();
  DoubleMatrix eHid=expHidI.div(pool(expHidI));
  return eHid;
}
