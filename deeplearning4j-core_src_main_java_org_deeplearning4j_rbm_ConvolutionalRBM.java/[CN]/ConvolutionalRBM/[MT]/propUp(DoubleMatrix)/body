{
  for (int i=0; i < numFilters[0]; i++) {
    for (int j=0; j < numFilters[1]; j++) {
      DoubleMatrix reversedSlice=reverse(W.getSliceOfTensor(i,j));
      DoubleMatrix slice=sigmoid(conv2d(v,reversedSlice,VALID).add(hBias.get(i)));
      hidI.put(i,j,slice);
    }
  }
  FourDTensor expHidI=MatrixUtil.exp(hidI);
  FourDTensor eHid=expHidI.div((DoubleMatrix)pool(expHidI).add(1));
  this.eHid=eHid;
  return eHid;
}
