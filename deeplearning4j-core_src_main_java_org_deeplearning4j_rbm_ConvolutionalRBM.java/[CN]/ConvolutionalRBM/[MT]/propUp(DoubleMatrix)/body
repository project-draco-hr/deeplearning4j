{
  for (int i=0; i < numFilters; i++) {
    DoubleMatrix reversedSlice=reverse(W.getSlice(i));
    DoubleMatrix slice=conv2d(v,reversedSlice,VALID).add(hBias.get(i));
    hidI.setSlice(i,slice);
  }
  Tensor expHidI=hidI.exp();
  Tensor eHid=expHidI.div(pool(expHidI).add(1));
  this.eHid=eHid;
  return eHid;
}
