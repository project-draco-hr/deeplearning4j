{
  FourDTensor h1Mean=propUp(v);
  FourDTensor h1Sample=new FourDTensor(binomial(h1Mean,1,rng));
  applyDropOutIfNecessary(h1Sample);
  return new Pair<>((DoubleMatrix)h1Mean,(DoubleMatrix)h1Sample);
}
