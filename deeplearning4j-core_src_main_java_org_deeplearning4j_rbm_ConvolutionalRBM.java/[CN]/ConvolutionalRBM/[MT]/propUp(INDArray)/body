{
  for (int i=0; i < numFilters[0]; i++) {
    for (int j=0; j < numFilters[1]; j++) {
      INDArray reversedSlice=NDArrays.reverse(W.slice(i).slice(j));
      INDArray slice=Transforms.sigmoid(Convolution.convn(v,reversedSlice,Convolution.Type.VALID).addi(hBias.getScalar(i)));
      hidI.put(i,j,slice);
    }
  }
  INDArray expHidI=Transforms.exp(hidI.dup());
  INDArray eHid=expHidI.div(pool(expHidI).add(1));
  this.eHid=eHid;
  return eHid;
}
