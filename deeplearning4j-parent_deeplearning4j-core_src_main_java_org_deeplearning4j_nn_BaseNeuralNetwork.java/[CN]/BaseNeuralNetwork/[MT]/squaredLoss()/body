{
  DoubleMatrix reconstructed=reconstruct(input);
  double loss=MatrixFunctions.powi(reconstructed.sub(input),2).sum() / input.rows;
  if (this.useRegularization) {
    loss+=0.5 * l2 * MatrixFunctions.pow(W,2).sum();
  }
  return -loss;
}
