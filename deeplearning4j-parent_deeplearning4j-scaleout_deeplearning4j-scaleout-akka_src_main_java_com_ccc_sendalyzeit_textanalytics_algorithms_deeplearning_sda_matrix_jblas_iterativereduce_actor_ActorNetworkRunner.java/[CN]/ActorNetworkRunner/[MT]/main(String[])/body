{
  final ActorNetworkRunner runner=args.length >= 2 ? args.length >= 3 ? new ActorNetworkRunner(args[1],args[2]) : new ActorNetworkRunner(args[0]) : new ActorNetworkRunner();
  Conf conf=new Conf();
  Integer[] hidden_layer_sizes_arr={300,300,300};
  double pretrain_lr=0.1;
  int pretraining_epochs=1000;
  double finetune_lr=0.1;
  int finetune_epochs=500;
  final Pair<DoubleMatrix,DoubleMatrix> mnist=DeepLearningTest.getMnistExampleBatch(100);
  conf.put(CLASS,"com.ccc.sendalyzeit.textanalytics.algorithms.deeplearning.sda.matrix.jblas.SdAMatrix");
  conf.put(LAYER_SIZES,Arrays.toString(hidden_layer_sizes_arr).replace("[","").replace("]","").replace(" ",""));
  conf.put(SPLIT,String.valueOf(10));
  conf.put(N_IN,String.valueOf(mnist.getFirst().columns));
  conf.put(OUT,String.valueOf(mnist.getSecond().columns));
  conf.put(PRE_TRAIN_EPOCHS,100);
  conf.put(FINE_TUNE_EPOCHS,100);
  conf.put(SEED,1);
  conf.put(LEARNING_RATE,0.1);
  conf.put(LAYER_SIZES,StringUtils.join(hidden_layer_sizes_arr,","));
  conf.put(CORRUPTION_LEVEL,0.3);
  conf.put(SPLIT,1);
  conf.put(PARAMS,new ExtraParamsBuilder().algorithm(PARAM_SDA).corruptionlevel(0.5).finetuneEpochs(finetune_epochs).finetuneLearningRate(finetune_lr).learningRate(pretrain_lr).epochs(pretraining_epochs).build());
  runner.setup(conf);
  log.info("Running training");
  runner.train(mnist.getFirst(),mnist.getSecond());
  BaseMultiLayerNetwork trained=runner.getResult().get();
  Evaluation eval=new Evaluation();
  DoubleMatrix predicted=trained.predict(mnist.getFirst());
  eval.eval(mnist.getSecond(),predicted);
  log.info(eval.stats());
  runner.shutdown();
}
