{
  if (conf.getLossFunction() == LossFunctions.LossFunction.CUSTOM) {
    LossFunction create=Nd4j.getOpFactory().createLossFunction(conf.getCustomLossFunction(),input,z);
    create.exec();
    score=create.currentResult().doubleValue();
  }
 else {
    score=LossCalculation.builder().l1(1.0).l2(1.0).l1Magnitude(fullNetworkL1).l2Magnitude(fullNetworkL2).labels(labels).z(z).lossFunction(conf.getLossFunction()).miniBatch(true).useRegularization(conf.isUseRegularization()).build().score();
  }
}
