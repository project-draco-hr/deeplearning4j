{
  if (input == null || labels == null)   return;
  INDArray output=output(input);
  if (conf.getLossFunction() == LossFunctions.LossFunction.CUSTOM) {
    LossFunction create=Nd4j.getOpFactory().createLossFunction(conf.getCustomLossFunction(),input,output);
    create.exec();
    score=create.currentResult().doubleValue();
  }
 else {
    score=LossFunctions.score(labels,conf.getLossFunction(),output,conf.getL2(),conf.isUseRegularization());
  }
  if (conf.isMinimize())   score=-score;
}
