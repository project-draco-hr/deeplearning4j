{
  if (x == null)   throw new IllegalArgumentException("No null input allowed");
  INDArray preOutput=preOutput(x);
  INDArray ret=Nd4j.getExecutioner().execAndReturn(Nd4j.getOpFactory().createTransform("softmax",preOutput),1);
  applyDropOutIfNecessary(ret);
  return ret;
}
