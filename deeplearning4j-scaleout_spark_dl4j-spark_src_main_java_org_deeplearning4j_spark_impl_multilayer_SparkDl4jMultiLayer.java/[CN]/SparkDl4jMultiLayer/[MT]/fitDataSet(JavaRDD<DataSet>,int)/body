{
  int nSplits;
  if (examplesPerFit == Integer.MAX_VALUE)   nSplits=1;
 else {
    long nExamples=rdd.count();
    if (nExamples % examplesPerFit == 0) {
      nSplits=(int)(nExamples / examplesPerFit);
    }
 else {
      nSplits=(int)(nExamples / examplesPerFit) + 1;
    }
  }
  if (nSplits == 1) {
    fitDataSet(rdd);
  }
 else {
    double[] splitWeights=new double[nSplits];
    for (int i=0; i < nSplits; i++)     splitWeights[i]=1.0 / nSplits;
    JavaRDD<DataSet>[] subsets=rdd.randomSplit(splitWeights);
    for (int i=0; i < subsets.length; i++) {
      log.info("Initiating distributed training of subset {} of {}",(i + 1),subsets.length);
      fitDataSet(subsets[i]);
    }
  }
  return network;
}
