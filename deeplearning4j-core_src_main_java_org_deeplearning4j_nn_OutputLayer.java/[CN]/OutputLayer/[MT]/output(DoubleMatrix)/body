{
  if (x == null)   throw new IllegalArgumentException("No null input allowed");
  this.input=x;
  DoubleMatrix ret=activationFunction.apply(this.input.mmul(W).addRowVector(b));
  applyDropOutIfNecessary(ret);
  return ret;
}
