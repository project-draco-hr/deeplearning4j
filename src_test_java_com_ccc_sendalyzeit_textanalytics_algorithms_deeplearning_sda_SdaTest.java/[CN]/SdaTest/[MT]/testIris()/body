{
  Pair<DoubleMatrix,DoubleMatrix> pair=IrisUtils.loadIris(1000);
  DoubleMatrix input=pair.getFirst();
  DoubleMatrix y=pair.getSecond();
  int[] hidden_layer_sizes_arr={300,300};
  SdAMatrix sdaMatrix=new SdAMatrix(input.columns,hidden_layer_sizes_arr,y.columns,n_layers,rng,input,train_Y_matrix);
  sdaMatrix.pretrain(pretrain_lr,0.5,1000);
  sdaMatrix.finetune(finetune_lr,1000);
  DoubleMatrix output=sdaMatrix.predict(input);
  int numCorrect=0;
  Counter<Integer> yIndices=new Counter<Integer>();
  Counter<Integer> guessIndices=new Counter<Integer>();
  for (int i=0; i < y.rows; i++) {
    int yMax=SimpleBlas.iamax(y.getRow(i));
    int outputMax=SimpleBlas.iamax(output.getRow(i));
    yIndices.incrementCount(yMax,1.0);
    guessIndices.incrementCount(outputMax,1.0);
    if (yMax == outputMax) {
      numCorrect++;
    }
  }
  log.info("Y " + yIndices.toString());
  log.info("Guesses " + guessIndices.toString());
  log.info("Correct was " + numCorrect);
}
