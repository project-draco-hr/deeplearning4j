{
  ComplexDoubleMatrix base;
  if (input.rows < rows || input.columns < cols)   base=MatrixUtil.complexPadWithZeros(input,rows,cols);
 else   if (input.rows > rows || input.columns > cols) {
    base=input.dup();
    base=base.get(MatrixUtil.toIndices(RangeUtils.interval(0,rows)),MatrixUtil.toIndices(RangeUtils.interval(0,cols)));
  }
 else   base=input.dup();
  ComplexDoubleMatrix temp=new ComplexDoubleMatrix(base.rows,base.columns);
  ComplexDoubleMatrix ret=new ComplexDoubleMatrix(base.rows,base.columns);
  for (int i=0; i < base.columns; i++) {
    ComplexDoubleMatrix column=base.getColumn(i);
    temp.putColumn(i,new VectorFFT(column.length).apply((ComplexNDArray.wrap(column))));
  }
  for (int i=0; i < ret.rows; i++) {
    ComplexDoubleMatrix row=temp.getRow(i);
    ret.putRow(i,new VectorFFT(row.length).apply((ComplexNDArray.wrap(row))));
  }
  return ret;
}
