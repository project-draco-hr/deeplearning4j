{
  int length=0;
  for (  INDArray m : matrices)   length+=m.length();
  INDArray ret=NDArrays.create(length);
  int linearIndex=0;
  for (  INDArray d : matrices) {
    INDArray flattened=d.linearView();
    for (int i=0; i < d.length(); i++) {
      ret.putScalar(linearIndex++,flattened.get(i));
    }
  }
  return ret;
}
