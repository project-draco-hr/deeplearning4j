{
  if (normalize) {
    INDArray mean=X.mean(0);
    X=X.subiRowVector(mean);
  }
  IComplexNDArray xWrapped=Nd4j.createComplex(X);
  IComplexNDArray xTimesX=xWrapped.transpose().mmul(xWrapped);
  IComplexNDArray M=Eigen.eigenvectors(xTimesX)[1];
  INDArray ret=xWrapped.mmul(M.get(NDArrayIndex.interval(0,M.rows()),NDArrayIndex.interval(0,nDims))).getReal();
  return ret;
}
