{
  double[][] list=new double[layers.length * 2 + 2][];
  int length=0;
  List<Pair<DoubleMatrix,DoubleMatrix>> deltas=backPropGradientR();
  int deltaCount=0;
  for (int i=0; i < list.length - 1; i+=2) {
    list[i]=deltas.get(deltaCount).getFirst().reshape(1,deltas.get(deltaCount).getFirst().length).data;
    list[i + 1]=deltas.get(deltaCount).getSecond().reshape(1,deltas.get(deltaCount).getSecond().length).data;
    length+=deltas.get(deltaCount).getFirst().length;
    length+=list[i + 1].length;
    deltaCount++;
  }
  double[] data=ArrayUtil.combine(list);
  return new DoubleMatrix(data).reshape(1,length);
}
