{
  DoubleMatrix currInput=x;
  for (int i=0; i < layerNum - 1; i++) {
    getLayers()[i].setInput(currInput);
    getSigmoidLayers()[i].setInput(input);
    if (useHiddenActivationsForwardProp)     currInput=getSigmoidLayers()[i].activate(currInput);
 else     currInput=getLayers()[i].sampleHiddenGivenVisible(currInput).getSecond();
  }
  return getLayers()[layerNum - 1].reconstruct(currInput);
}
