{
  if (layerNum > getnLayers() || layerNum < 0)   throw new IllegalArgumentException("Layer number " + layerNum + " does not exist");
  if (columnSums != null) {
    for (int i=0; i < x.columns; i++) {
      DoubleMatrix col=x.getColumn(i);
      col=col.div(columnSums.get(0,i));
      x.putColumn(i,col);
    }
  }
  if (columnMeans != null) {
    for (int i=0; i < x.columns; i++) {
      DoubleMatrix col=x.getColumn(i);
      col=col.sub(columnMeans.get(0,i));
      x.putColumn(i,col);
    }
  }
  if (columnStds != null) {
    for (int i=0; i < x.columns; i++) {
      DoubleMatrix col=x.getColumn(i);
      col=col.div(columnStds.get(0,i));
      x.putColumn(i,col);
    }
  }
  DoubleMatrix input=x;
  for (int i=0; i < layerNum; i++) {
    HiddenLayer layer=sigmoidLayers[i];
    input=layer.activate(input);
  }
  return input;
}
