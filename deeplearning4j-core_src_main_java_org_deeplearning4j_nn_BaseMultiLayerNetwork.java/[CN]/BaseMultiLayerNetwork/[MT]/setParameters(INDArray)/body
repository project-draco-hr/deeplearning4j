{
  for (int i=0; i < getLayers().length; i++) {
    ParamRange range=startIndexForLayer(i);
    INDArray w=params.get(NDArrayIndex.interval(0,params.rows()),NDArrayIndex.interval(range.getwStart(),range.getwEnd()));
    INDArray bias=params.get(NDArrayIndex.interval(0,params.rows()),NDArrayIndex.interval(range.getBiasStart(),range.getBiasEnd()));
    int rows=getLayers()[i].getW().rows(), columns=getLayers()[i].getW().columns();
    getLayers()[i].setW(w.reshape(rows,columns));
    getLayers()[i].sethBias(bias.reshape(getLayers()[i].gethBias().rows(),getLayers()[i].gethBias().columns()));
  }
  ParamRange range=startIndexForLayer(getLayers().length);
  INDArray w=params.get(NDArrayIndex.interval(0,params.rows()),NDArrayIndex.interval(range.getwStart(),range.getwEnd()));
  INDArray bias=params.get(NDArrayIndex.interval(0,params.rows()),NDArrayIndex.interval(range.getBiasStart(),range.getBiasEnd()));
  int rows=getOutputLayer().getW().rows(), columns=getOutputLayer().getW().columns();
  getOutputLayer().setW(w.reshape(rows,columns));
  getOutputLayer().setB(bias.reshape(getOutputLayer().getB().rows(),getOutputLayer().getB().columns()));
}
