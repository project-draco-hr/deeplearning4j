{
  if (layers == null || layers.length < 1) {
    throw new IllegalStateException("Layers not initialized");
  }
  for (int i=0; i < layers.length; i++) {
    if (weightTransforms.containsKey(i))     layers[i].setW(weightTransforms.get(i).apply(layers[i].getW()));
    if (hiddenBiasTransforms.containsKey(i))     layers[i].sethBias(getHiddenBiasTransforms().get(i).apply(layers[i].gethBias()));
    if (this.visibleBiasTransforms.containsKey(i))     layers[i].setvBias(getVisibleBiasTransforms().get(i).apply(layers[i].getvBias()));
  }
}
