{
  INDArray params=params();
  setParameters(param);
  float ret=score();
  float regCost=0.5f * defaultConfiguration.getL2() * (float)Transforms.pow(mask.mul(param),2).sum(Integer.MAX_VALUE).element();
  setParameters(params);
  return ret + regCost;
}
