{
  if (layers.size() != this.neuralNets.length + 1)   throw new IllegalArgumentException("Illegal number of neuralNets passed in. Was " + layers.size() + " when should have been "+ (this.neuralNets.length + 1));
  List<INDArray> list=new ArrayList<>();
  for (int i=0; i < layers.size(); i++) {
    list.add(layers.get(i).getFirst());
    list.add(layers.get(i).getSecond());
  }
  INDArray ret=NDArrays.toFlattened(list);
  if (ret.length() != numParams())   throw new IllegalStateException("Illegal number of parameters found in the layers with a difference of " + Math.abs(ret.length() - numParams()));
  return ret;
}
