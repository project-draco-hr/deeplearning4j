{
  List<Pair<INDArray,INDArray>> deltas=backPropGradient();
  for (int i=0; i < layers.length; i++) {
    layers[i].getW().subi(deltas.get(i).getFirst());
    layers[i].getB().subi(deltas.get(i).getSecond());
    if (i < neuralNets.length) {
      neuralNets[i].setW(layers[i].getW());
      neuralNets[i].sethBias(layers[i].getB());
    }
  }
}
