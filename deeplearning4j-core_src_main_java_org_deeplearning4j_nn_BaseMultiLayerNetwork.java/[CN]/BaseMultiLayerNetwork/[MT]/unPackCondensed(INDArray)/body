{
  int numParams=numParams();
  if (param.length() != numParams)   throw new IllegalArgumentException("Parameter vector not equal of length to " + numParams);
  List<INDArray> ret=new ArrayList<>();
  int curr=0;
  for (int i=0; i < layers.length; i++) {
    int layerLength=layers[i].getW().length() + layers[i].gethBias().length();
    INDArray subMatrix=param.get(NDArrayIndex.interval(0,param.rows()),NDArrayIndex.interval(curr,curr + layerLength));
    INDArray weightPortion=subMatrix.get(NDArrayIndex.interval(0,subMatrix.rows()),NDArrayIndex.interval(0,layers[i].getW().length()));
    int beginHBias=layers[i].getW().length();
    int endHbias=subMatrix.length();
    INDArray hBiasPortion=subMatrix.get(NDArrayIndex.interval(0,subMatrix.rows()),NDArrayIndex.interval(beginHBias,endHbias));
    int layerLengthSum=weightPortion.length() + hBiasPortion.length();
    if (layerLengthSum != layerLength) {
      if (hBiasPortion.length() != layers[i].gethBias().length())       throw new IllegalStateException("Hidden bias on layer " + i + " was off");
      if (weightPortion.length() != layers[i].getW().length())       throw new IllegalStateException("Weight portion on layer " + i + " was off");
    }
    INDArray d=NDArrays.create(1,weightPortion.length() + hBiasPortion.length());
    d.put(new NDArrayIndex[]{NDArrayIndex.interval(0,d.rows()),NDArrayIndex.interval(0,weightPortion.length())},weightPortion);
    d.put(new NDArrayIndex[]{NDArrayIndex.interval(0,d.rows()),NDArrayIndex.interval(weightPortion.length(),d.length())},hBiasPortion);
    ret.add(d);
    curr+=layerLength;
  }
  int outputLayerWeightLength=outputLayer.getW().length();
  int biasLength=outputLayer.getB().length();
  int layerLength=outputLayerWeightLength + biasLength;
  INDArray subMatrix=param.get(NDArrayIndex.interval(0,param.rows()),NDArrayIndex.interval(curr,curr + layerLength));
  INDArray weightPortion=subMatrix.get(NDArrayIndex.interval(0,subMatrix.rows()),NDArrayIndex.interval(0,outputLayer.getW().length()));
  INDArray hBiasPortion=subMatrix.get(NDArrayIndex.interval(0,subMatrix.rows()),NDArrayIndex.interval(weightPortion.length(),subMatrix.length()));
  INDArray d=NDArrays.create(1,weightPortion.length() + hBiasPortion.length());
  d.put(new NDArrayIndex[]{NDArrayIndex.interval(0,d.rows()),NDArrayIndex.interval(0,weightPortion.length())},weightPortion);
  d.put(new NDArrayIndex[]{NDArrayIndex.interval(0,subMatrix.rows()),NDArrayIndex.interval(weightPortion.length(),d.length())},hBiasPortion);
  ret.add(d);
  return ret;
}
