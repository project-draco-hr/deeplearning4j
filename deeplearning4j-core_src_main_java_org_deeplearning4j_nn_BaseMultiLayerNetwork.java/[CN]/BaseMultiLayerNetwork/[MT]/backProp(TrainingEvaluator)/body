{
  if (layerWiseConfigurations.isUseGaussNewtonVectorProductBackProp()) {
    BackPropROptimizer opt=new BackPropROptimizer(this,defaultConfiguration.getLr(),defaultConfiguration.getNumIterations());
    opt.optimize(eval);
  }
 else {
    SoftMaxOptimizer opt=new SoftMaxOptimizer(this,defaultConfiguration.getLr(),defaultConfiguration.getNumIterations());
    opt.optimize(eval);
  }
}
