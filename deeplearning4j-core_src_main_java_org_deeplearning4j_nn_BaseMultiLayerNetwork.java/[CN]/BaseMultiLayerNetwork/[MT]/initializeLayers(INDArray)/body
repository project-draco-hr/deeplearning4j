{
  if (input == null)   throw new IllegalArgumentException("Unable to initialize layers with empty input");
  if (input.columns() != nIns)   throw new IllegalArgumentException(String.format("Unable to iterate on number of inputs; columns should be equal to number of inputs. Number of inputs was %d while number of columns was %d",nIns,input.columns()));
  if (this.layers == null)   this.layers=new NeuralNetwork[getnLayers()];
  for (int i=0; i < hiddenLayerSizes.length; i++)   if (hiddenLayerSizes[i] < 1)   throw new IllegalArgumentException("All hidden layer sizes must be >= 1");
  this.input=input.dup();
  if (!initCalled) {
    init();
    log.info("Initializing layers with input of dims " + input.rows() + " x "+ input.columns());
  }
}
