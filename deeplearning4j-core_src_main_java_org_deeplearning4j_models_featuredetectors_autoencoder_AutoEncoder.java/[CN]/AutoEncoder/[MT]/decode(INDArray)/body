{
  INDArray W=getParam(PretrainParamInitializer.WEIGHT_KEY);
  INDArray vBias=getParam(PretrainParamInitializer.VISIBLE_BIAS_KEY);
  if (conf.isConcatBiases()) {
    INDArray preAct=y.mmul(W.transposei());
    preAct=Nd4j.hstack(preAct,Nd4j.ones(preAct.rows(),1));
    return Nd4j.getExecutioner().execAndReturn(Nd4j.getOpFactory().createTransform(conf.getActivationFunction(),preAct));
  }
 else {
    INDArray preAct=y.mmul(W.transposei());
    preAct.addiRowVector(vBias);
    return Nd4j.getExecutioner().execAndReturn(Nd4j.getOpFactory().createTransform(conf.getActivationFunction(),preAct));
  }
}
