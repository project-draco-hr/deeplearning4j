{
  if (this.input == null)   throw new IllegalStateException("Unable to perform feed forward; no input found");
  List<DoubleMatrix> activations=new ArrayList<>();
  DoubleMatrix input=this.input;
  activations.add(input);
  for (int i=0; i < nLayers; i++) {
    HiddenLayer layer=sigmoidLayers[i];
    layers[i].setInput(input);
    input=layer.activate(input);
    activations.add(input);
  }
  activations.add(logLayer.predict(input));
  return activations;
}
