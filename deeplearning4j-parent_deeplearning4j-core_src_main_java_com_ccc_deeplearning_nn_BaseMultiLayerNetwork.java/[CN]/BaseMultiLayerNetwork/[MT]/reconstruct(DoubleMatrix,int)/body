{
  if (layerNum > nLayers || layerNum < 0)   throw new IllegalArgumentException("Layer number " + layerNum + " does not exist");
  DoubleMatrix input=x;
  for (int i=0; i < layerNum; i++) {
    HiddenLayer layer=sigmoidLayers[i];
    input=layer.activate(input);
  }
  return MatrixUtil.softmax(input);
}
