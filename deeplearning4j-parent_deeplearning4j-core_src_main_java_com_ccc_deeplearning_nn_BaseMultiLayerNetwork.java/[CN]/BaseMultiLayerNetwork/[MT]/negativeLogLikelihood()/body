{
  double ret=0.0;
  for (int i=0; i < nLayers; i++) {
    ret+=(MatrixFunctions.pow(layers[i].getW(),2).sum() / 2.0) * l2;
  }
  ret+=(MatrixFunctions.pow(logLayer.W,2).sum() / 2.0) * l2;
  return ret;
}
