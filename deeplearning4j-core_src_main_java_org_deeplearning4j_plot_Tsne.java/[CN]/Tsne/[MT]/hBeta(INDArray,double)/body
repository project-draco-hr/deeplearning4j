{
  INDArray P=exp(d.neg().muli(beta));
  double sum=P.sumNumber().doubleValue();
  double logSum=FastMath.log(sum);
  INDArray H=d.mul(P).sum(0).muli(beta).divi(sum).addi(logSum);
  P.divi(sum);
  return new Pair<>(H,P);
}
