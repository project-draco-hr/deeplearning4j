{
  NeuralNetConfiguration conf=NeuralNetConfiguration.fromJson(json);
  LayerFactory layerFactory=LayerFactories.getFactory(conf.getLayer());
  if (layerFactory == null)   throw new IllegalStateException("Please specify a layer factory");
  int numParams=layerFactory.initializer().numParams(conf,true);
  INDArray thisParams=Nd4j.create(1,numParams);
  this.network=layerFactory.create(conf,null,0,thisParams);
  if (numParams != params.length())   throw new IllegalStateException("Number of params for configured network was " + numParams + " while the specified parameter vector length was "+ params.length());
  Layer network=(Layer)this.network;
  network.setParams(params);
}
