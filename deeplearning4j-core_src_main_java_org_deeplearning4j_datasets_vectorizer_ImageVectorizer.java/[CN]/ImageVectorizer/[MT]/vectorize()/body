{
  try {
    INDArray d=loader.asMatrix(image);
    INDArray label2=FeatureUtil.toOutcomeVector(label,numLabels);
    if (normalize) {
      d=d.div(255);
    }
 else     if (binarize) {
      for (int i=0; i < d.length(); i++) {
        double curr=(double)d.getScalar(i).element();
        if (curr > threshold) {
          d.putScalar(i,1);
        }
 else         d.putScalar(i,0);
      }
    }
    return new DataSet(d,label2);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
