{
  if (this.input == null)   return;
  INDArray output=transform(input);
  if (conf.getLossFunction() == LossFunctions.LossFunction.CUSTOM) {
    LossFunction create=Nd4j.getOpFactory().createLossFunction(conf.getCustomLossFunction(),input,output);
    create.exec();
    score=-create.currentResult().doubleValue();
  }
 else {
    score=-LossFunctions.score(input,conf.getLossFunction(),output,conf.getL2(),conf.isUseRegularization());
  }
  if (conf.isMinimize())   score=-score;
}
