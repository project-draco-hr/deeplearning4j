{
  if (this.input == null)   return;
  INDArray output=transform(input);
  if (conf.getLossFunction() == LossFunctions.LossFunction.CUSTOM) {
    LossFunction create=Nd4j.getOpFactory().createLossFunction(conf.getCustomLossFunction(),input,output);
    create.exec();
    score=create.currentResult().doubleValue();
  }
 else {
    score=LossCalculation.builder().l1(conf.getL1()).l2(conf.getL2()).l1Magnitude(l1Magnitude()).l2Magnitude(l2Magnitude()).labels(input).z(output).lossFunction(conf.getLossFunction()).useRegularization(conf.isUseRegularization()).build().score();
  }
}
