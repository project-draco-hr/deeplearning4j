{
  INDArray W=getParam(DefaultParamInitializer.WEIGHT_KEY);
  INDArray b=getParam(DefaultParamInitializer.BIAS_KEY);
  Layer layer=null;
  try {
    Constructor c=getClass().getConstructor(NeuralNetConfiguration.class,INDArray.class,INDArray.class,INDArray.class);
    NeuralNetConfiguration clone=conf.clone();
    int nIn=clone.getnOut(), nOut=clone.getnIn();
    clone.setnIn(nIn);
    clone.setnOut(nOut);
    layer=(Layer)c.newInstance(conf,W.transpose().dup(),b.transpose().dup(),input != null ? input.transpose().dup() : null);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
  return layer;
}
