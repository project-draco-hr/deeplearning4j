{
  if (input != null) {
    this.input=input.dup();
    applyDropOutIfNecessary(this.input);
  }
  Solver solver=new Solver.Builder().model(this).configure(conf()).listeners(getListeners()).build();
  this.optimizer=solver.getOptimizer();
  solver.optimize();
}
