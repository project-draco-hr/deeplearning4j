{
  if (input != null) {
    setInput(input.dup());
    applyDropOutIfNecessary(true);
  }
  if (solver == null) {
    solver=new Solver.Builder().model(this).configure(conf()).listeners(getListeners()).build();
  }
  this.optimizer=solver.getOptimizer();
  solver.optimize();
}
