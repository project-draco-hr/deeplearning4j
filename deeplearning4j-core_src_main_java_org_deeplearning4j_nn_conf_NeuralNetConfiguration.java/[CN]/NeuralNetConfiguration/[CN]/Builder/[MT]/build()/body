{
  if (layer == null)   throw new IllegalStateException("No layer defined.");
  NeuralNetConfiguration conf=new NeuralNetConfiguration();
  conf.minimize=minimize;
  conf.maxNumLineSearchIterations=maxNumLineSearchIterations;
  conf.batchSize=batchSize;
  conf.layer=layer;
  conf.numIterations=numIterations;
  conf.momentum=momentum;
  conf.useRegularization=useRegularization;
  conf.momentumAfter=momentumAfter;
  conf.optimizationAlgo=optimizationAlgo;
  conf.constrainGradientToUnitNorm=constrainGradientToUnitNorm;
  conf.seed=seed;
  conf.timeSeriesLength=timeSeriesLength;
  conf.rmsDecay=rmsDecay;
  conf.stepFunction=stepFunction;
  conf.useDropConnect=useDropConnect;
  conf.miniBatch=miniBatch;
  conf.rho=rho;
  conf.lr=(Double.isNaN(layer.getLr()) ? lr : layer.getLr());
  conf.l1=(Double.isNaN(layer.getL1()) ? l1 : layer.getL1());
  conf.l2=(Double.isNaN(layer.getL2()) ? l2 : layer.getL2());
  conf.weightInit=(layer.getWeightInit() == null ? weightInit : layer.getWeightInit());
  conf.biasInit=(Double.isNaN(layer.getBiasInit()) ? biasInit : layer.getBiasInit());
  conf.dist=(layer.getDist() == null ? dist : layer.getDist());
  conf.dropOut=(Double.isNaN(layer.getDropOut()) ? dropOut : layer.getDropOut());
  conf.updater=(layer.getUpdater() == null ? updater : layer.getUpdater());
  conf.activationFunction=activationFunction;
  return conf;
}
