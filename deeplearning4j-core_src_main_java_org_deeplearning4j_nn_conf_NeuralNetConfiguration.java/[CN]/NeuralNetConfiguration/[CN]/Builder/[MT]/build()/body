{
  if (layer == null)   throw new IllegalStateException("No layer defined.");
  NeuralNetConfiguration ret=new NeuralNetConfiguration(lr,numIterations,momentum,l2,useRegularization,momentumAfter,optimizationAlgo,constrainGradientToUnitNorm,seed,timeSeriesLength,batchSize,maxNumLineSearchIterations,minimize,layer,l1);
  ret.rmsDecay=rmsDecay;
  ret.stepFunction=stepFunction;
  ret.useDropConnect=useDropConnect;
  ret.miniBatch=miniBatch;
  ret.rho=rho;
  return ret;
}
