{
  List<NeuralNetConfiguration> list=new ArrayList<>();
  for (int i=0; i < layerwise.size(); i++) {
    list.add(layerwise.get(i).build());
  }
  return new MultiLayerConfiguration.Builder().backprop(backprop).inputPreProcessors(inputPreProcessors).pretrain(pretrain).backpropType(backpropType).tBPTTForwardLength(tbpttFwdLength).tBPTTBackwardLength(tbpttBackLength).redistributeParams(redistributeParams).cnnInputSize(cnnInputSize).confs(list).build();
}
