{
  if (layerwise.size() != hiddenLayerSizes.length + 1)   throw new IllegalStateException("Number of hidden layers mut be equal to hidden layer sizes + 1");
  List<NeuralNetConfiguration> list=new ArrayList<>();
  for (int i=0; i < layerwise.size(); i++)   list.add(layerwise.get(i).build());
  return new MultiLayerConfiguration.Builder().useDropConnect(useDropConnect).pretrain(pretrain).preProcessors(preProcessors).hiddenLayerSizes(hiddenLayerSizes).confs(list).build();
}
