{
  MnistDataFetcher fetcher=new MnistDataFetcher(true);
  fetcher.fetch(100);
  DataSet d=fetcher.next();
  d.filterAndStrip(new int[]{0,1});
  log.info("Training on " + d.numExamples());
  StopWatch watch=new StopWatch();
  log.info("Data applyTransformToDestination " + d);
  DBN dbn=new DBN.Builder().withActivation(Activations.sigmoid()).hiddenLayerSizes(new int[]{500,250,100}).withMomentum(0.5f).normalizeByInputRows(true).numberOfInputs(784).useAdaGrad(true).numberOfOutPuts(2).build();
  watch.start();
  dbn.pretrain(d.getFeatureMatrix(),1,1e-2f,300);
  dbn.finetune(d.getLabels(),1e-2f,100);
  watch.stop();
  log.info("Took " + watch.getTime());
  Evaluation eval=new Evaluation();
  INDArray predict=dbn.output(d.getFeatureMatrix());
  eval.eval(d.getLabels(),predict);
  log.info(eval.stats());
}
