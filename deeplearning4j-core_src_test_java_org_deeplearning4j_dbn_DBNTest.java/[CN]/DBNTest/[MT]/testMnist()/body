{
  MnistDataFetcher fetcher=new MnistDataFetcher();
  fetcher.fetch(1000);
  DataSet d=fetcher.next();
  assertEquals(1000,d.numExamples());
  DBN dbn=new DBN.Builder().hiddenLayerSizes(new int[]{500,250,100}).withActivation(new HardTanh()).numberOfInputs(784).numberOfOutPuts(10).useRegularization(false).build();
  dbn.pretrain(d.getFirst(),1,0.0001,30000);
  dbn.finetune(d.getSecond(),0.0001,10000);
  Evaluation eval=new Evaluation();
  DoubleMatrix predict=dbn.predict(d.getFirst());
  eval.eval(d.getSecond(),predict);
  log.info(eval.stats());
}
