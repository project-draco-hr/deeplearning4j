{
  MnistDataFetcher fetcher=new MnistDataFetcher(true);
  fetcher.fetch(100);
  DataSet d=fetcher.next();
  d.filterAndStrip(new int[]{0,1});
  log.info("Training on " + d.numExamples());
  StopWatch watch=new StopWatch();
  log.info("Data set " + d);
  DBN dbn=new DBN.Builder().withActivation(Activations.sigmoid()).hiddenLayerSizes(new int[]{500,250,100}).withMomentum(0.5).normalizeByInputRows(true).numberOfInputs(784).useAdaGrad(true).numberOfOutPuts(2).build();
  watch.start();
  dbn.pretrain(d.getFirst(),1,1e-2,300);
  dbn.finetune(d.getSecond(),1e-2,100);
  watch.stop();
  log.info("Took " + watch.getTime());
  Evaluation eval=new Evaluation();
  DoubleMatrix predict=dbn.output(d.getFirst());
  eval.eval(d.getSecond(),predict);
  log.info(eval.stats());
}
