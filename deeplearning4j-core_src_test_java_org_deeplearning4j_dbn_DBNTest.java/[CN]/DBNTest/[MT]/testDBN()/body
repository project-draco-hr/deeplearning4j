{
  int n=50;
  DataSet d=MatrixUtil.xorData(n,500);
  DoubleMatrix x=d.getFirst();
  DoubleMatrix y=d.getSecond();
  double preTrainLr=0.0001;
  int preTrainEpochs=1000;
  int k=1;
  int[] hiddenLayerSizes=new int[]{400,250,100};
  double fineTuneLr=0.0001;
  int fineTuneEpochs=1000;
  DBN dbn=new DBN.Builder().forceEpochs().hiddenLayerSizes(hiddenLayerSizes).numberOfInputs(d.numInputs()).useRegularization(false).numberOfOutPuts(d.numOutcomes()).build();
  dbn.pretrain(x,k,preTrainLr,preTrainEpochs);
  dbn.finetune(y,fineTuneLr,fineTuneEpochs);
  DoubleMatrix predict=dbn.predict(x);
  Evaluation eval=new Evaluation();
  eval.eval(y,predict);
  log.info(eval.stats());
}
