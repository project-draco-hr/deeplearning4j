{
  Pair<DoubleMatrix,DoubleMatrix> first=this.getMnistExample(1);
  int numIns=first.getFirst().columns;
  int numLabels=10;
  int[] layerSizes=new int[4];
  int numEpochs=1000;
  Arrays.fill(layerSizes,300);
  double lr=0.1;
  SdAMatrix sda=new SdAMatrix.Builder().numberOfInputs(numIns).numberOfOutPuts(numLabels).withRng(new MersenneTwister(123)).hiddenLayerSizes(layerSizes).build();
  for (int i=2; i < 10; i++) {
    Pair<DoubleMatrix,DoubleMatrix> curr=this.getMnistExample(i);
    sda.pretrain(curr.getFirst(),lr,0.3,numEpochs);
    sda.finetune(curr.getSecond(),lr,numEpochs);
  }
}
