{
  model.setScore();
  Pair<Gradient,Double> pair=model.gradientAndScore();
  for (  String paramType : pair.getFirst().gradientForVariable().keySet()) {
    INDArray gradient=pair.getFirst().getGradientFor(paramType);
    updateGradientAccordingToParams(gradient,model,model.batchSize(),paramType,iteration);
  }
  return pair;
}
