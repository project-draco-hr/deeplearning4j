{
  MatrixUtil.complainAboutMissMatchedMatrices(input,labels);
  DoubleMatrix p_y_given_x=sigmoid(input.mmul(W).addRowVector(b));
  DoubleMatrix dy=labels.sub(p_y_given_x);
  if (useRegularization)   dy.divi(input.rows);
  DoubleMatrix wGradient=input.transpose().mmul(dy);
  if (useAdaGrad)   wGradient.muli(this.adaGrad.getLearningRates(wGradient));
 else   wGradient.mul(lr);
  DoubleMatrix bGradient=dy;
  return new LogisticRegressionGradient(wGradient,bGradient);
}
