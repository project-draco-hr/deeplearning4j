{
  if (data.isEmpty())   throw new IllegalArgumentException("Unable to merge empty dataset");
  FloatDataSet first=data.get(0);
  int numExamples=totalExamples(data);
  FloatMatrix in=new FloatMatrix(numExamples,first.getFirst().columns);
  FloatMatrix out=new FloatMatrix(numExamples,first.getSecond().columns);
  int count=0;
  for (int i=0; i < data.size(); i++) {
    FloatDataSet d1=data.get(i);
    for (int j=0; j < d1.numExamples(); j++) {
      FloatDataSet example=d1.get(j);
      in.putRow(count,example.getFirst());
      out.putRow(count,example.getSecond());
      count++;
    }
  }
  return new FloatDataSet(in,out);
}
