{
  int leadDim=x.size(0);
  int cDim=getParam(BatchNormalizationParamInitializer.GAMMA).length();
  int rdim=(int)((double)x.length() / ((double)leadDim * (double)cDim));
  if (leadDim * cDim * rdim != x.length())   throw new IllegalArgumentException("Illegal input for batch size");
  return new int[]{leadDim,cDim,rdim};
}
