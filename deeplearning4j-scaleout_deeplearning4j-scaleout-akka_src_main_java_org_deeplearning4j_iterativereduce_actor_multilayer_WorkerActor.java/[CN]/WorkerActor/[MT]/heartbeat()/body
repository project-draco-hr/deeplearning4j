{
  heartbeat=context().system().scheduler().schedule(Duration.apply(30,TimeUnit.SECONDS),Duration.apply(30,TimeUnit.SECONDS),new Runnable(){
    @Override public void run(){
      tracker.addWorker(id);
      if (tracker.needsReplicate(id)) {
        try {
          log.info("Updating worker " + id);
          if (tracker.getCurrent() == null || tracker.getCurrent().get() == null) {
            return;
          }
          setE(tracker.getCurrent());
          setNetwork(tracker.getCurrent().get());
          tracker.doneReplicating(id);
        }
 catch (        Exception e) {
          throw new RuntimeException(e);
        }
      }
      try {
        checkJobAvailable();
        if (currentJob != null && !isWorking.get() && tracker.jobFor(id) != null) {
          log.info("Confirmation from " + currentJob.getWorkerId() + " on work");
          DataSet data=(DataSet)currentJob.getWork();
          processDataSet(data.asList());
        }
 else         if (currentJob == null || !isWorking.get() && tracker.jobFor(id) != null) {
          if (tracker.jobFor(id) != null)           tracker.clearJob(id);
          log.info("Clearing stale job... " + id);
        }
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
,context().dispatcher());
}
