{
  log.info("Training network");
  blockTillNetworkAvailable();
  if (getCurrent() == null)   return null;
  if (this.getCurrent().isPretrain()) {
    log.info("Worker " + id + " pretraining");
    getNetwork().pretrain(this.getCombinedInput(),extraParams);
  }
 else {
    log.info("Worker " + id + " finetuning");
    getNetwork().finetune(outcomes,learningRate,fineTuneEpochs);
  }
  finishedWork();
  return new UpdateableImpl(getNetwork());
}
