{
  arr=arr.reshape(new int[]{1,arr.length()});
  NDArray cast=(NDArray)arr;
  if (op == ScalarOp.NORM_1) {
    return NDArray.scalar(NDArrayBlas.asum(cast));
  }
 else   if (op == ScalarOp.NORM_2) {
    return NDArray.scalar(NDArrayBlas.nrm2(cast));
  }
 else   if (op == ScalarOp.NORM_MAX) {
    int i=NDArrayBlas.iamax(cast);
    return arr.getScalar(i);
  }
  INDArray s=NDArray.scalar(0);
  for (int i=0; i < arr.length(); i++) {
switch (op) {
case SUM:
      s.addi(arr.getScalar(i));
    break;
case MEAN:
  s.addi(arr.getScalar(i));
break;
case MAX:
double curr=(double)arr.getScalar(i).element();
double sEle1=(double)arr.getScalar(i).element();
if (curr > sEle1) s=arr.getScalar(i);
break;
case MIN:
double curr2=(double)arr.getScalar(i).element();
double sEle2=(double)arr.getScalar(i).element();
if (curr2 < sEle2) s=arr.getScalar(i);
break;
case PROD:
s.muli(arr.getScalar(i));
break;
}
}
if (op == ScalarOp.MEAN) s.divi(NDArray.scalar(arr.length()));
return s;
}
