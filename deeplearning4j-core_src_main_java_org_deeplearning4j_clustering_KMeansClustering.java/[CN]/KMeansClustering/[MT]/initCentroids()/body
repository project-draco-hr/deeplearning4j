{
  this.counts=new ArrayList<>(this.nbCluster);
  for (int i=0; i < this.nbCluster; i++) {
    this.counts.add(0L);
  }
  Random random=new Random();
  final INDArray firstCentroid=this.initFeatures.remove(random.nextInt(this.initFeatures.size())).linearView();
  this.centroids=Nd4j.create(this.nbCluster,firstCentroid.columns());
  this.centroids.putRow(0,firstCentroid);
  log.info("Added initial centroid");
  INDArray dxs;
  for (int j=1; j < this.nbCluster; j++) {
    dxs=this.computeDxs();
    INDArray features;
    double r=random.nextFloat() * dxs.getDouble(dxs.length() - 1);
    for (int i=0; i < dxs.length(); i++) {
      if (dxs.getDouble(i) >= r) {
        features=this.initFeatures.remove(i);
        this.centroids.putRow(j,features);
        break;
      }
    }
  }
  this.initFeatures.clear();
}
