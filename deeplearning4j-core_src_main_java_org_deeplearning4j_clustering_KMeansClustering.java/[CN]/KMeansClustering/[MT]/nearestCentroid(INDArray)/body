{
  Integer nearestCentroidIndex=0;
  double minDistance=Float.MAX_VALUE;
  INDArray currentCentroid;
  double currentDistance;
  for (int i=0; i < this.centroids.rows(); i++) {
    currentCentroid=this.centroids.getRow(i);
    if (currentCentroid != null) {
      currentDistance=getDistance(currentCentroid,features);
      if (currentDistance < minDistance) {
        minDistance=currentDistance;
        nearestCentroidIndex=i;
      }
    }
  }
  return nearestCentroidIndex;
}
