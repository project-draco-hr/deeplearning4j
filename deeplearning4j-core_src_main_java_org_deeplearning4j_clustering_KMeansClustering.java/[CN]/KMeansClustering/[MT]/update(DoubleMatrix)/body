{
  if (!this.isReady()) {
    this.initIfPossible(features);
    log.info("Initializing feature vector with length of " + features.length);
    return null;
  }
 else {
    Integer nearestCentroid=this.classify(features);
    this.counts.set(nearestCentroid,this.counts.get(nearestCentroid) + 1);
    DoubleMatrix update=features.sub(this.centroids.getRow(nearestCentroid)).mul(1.0 / this.counts.get(nearestCentroid));
    this.centroids.putRow(nearestCentroid,this.centroids.getRow(nearestCentroid).add(update));
    return nearestCentroid;
  }
}
