{
  if (input == null || labels == null)   throw new IllegalStateException("Cannot calculate score without input and labels");
  INDArray preOut=preOutput2d(false);
  INDArray output=Nd4j.getExecutioner().execAndReturn(Nd4j.getOpFactory().createTransform(conf().getLayer().getActivationFunction(),preOut.dup()));
  return LossCalculation.builder().l1(fullNetworkL1).l2(fullNetworkL2).labels(getLabels2d()).z(output).preOut(preOut).activationFn(conf().getLayer().getActivationFunction()).lossFunction(layerConf().getLossFunction()).useRegularization(conf.isUseRegularization()).mask(maskArray).build().scoreExamples();
}
