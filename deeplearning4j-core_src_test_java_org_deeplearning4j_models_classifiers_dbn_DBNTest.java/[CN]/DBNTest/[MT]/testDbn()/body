{
  NeuralNetConfiguration conf=new NeuralNetConfiguration.Builder().lossFunction(LossFunctions.LossFunction.RMSE_XENT).learningRate(1e-1f).nIn(784).nOut(2).build();
  DBN d=new DBN.Builder().configure(conf).hiddenLayerSizes(new int[]{500,250}).build();
  d.getOutputLayer().conf().setActivationFunction(Activations.softmax());
  d.getOutputLayer().conf().setLossFunction(LossFunctions.LossFunction.MCXENT);
  MnistDataFetcher fetcher=new MnistDataFetcher(true);
  fetcher.fetch(100);
  DataSet d2=fetcher.next();
  d2.filterAndStrip(new int[]{0,1});
  d.fit(d2);
  int[] predict=d.predict(d2.getFeatureMatrix());
  log.info("Predict " + Arrays.toString(predict));
}
