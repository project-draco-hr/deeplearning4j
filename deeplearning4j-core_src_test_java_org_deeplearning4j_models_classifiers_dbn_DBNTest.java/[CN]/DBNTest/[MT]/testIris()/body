{
  RandomGenerator gen=new MersenneTwister(123);
  MultiLayerConfiguration conf=new NeuralNetConfiguration.Builder().iterations(1000).activationFunction(Activations.tanh()).visibleUnit(RBM.VisibleUnit.GAUSSIAN).hiddenUnit(RBM.HiddenUnit.RECTIFIED).lossFunction(LossFunctions.LossFunction.RMSE_XENT).weightInit(WeightInit.VI).optimizationAlgo(NeuralNetwork.OptimizationAlgorithm.ITERATION_GRADIENT_DESCENT).rng(gen).constrainGradientToUnitNorm(true).learningRate(1e-3f).nIn(4).nOut(3).list(3).hiddenLayerSizes(new int[]{3,2}).override(new NeuralNetConfiguration.ConfOverride(){
    @Override public void override(    int i,    NeuralNetConfiguration.Builder builder){
      if (i == 2) {
        builder.weightInit(WeightInit.ZERO);
        builder.activationFunction(Activations.softMaxRows());
        builder.lossFunction(LossFunctions.LossFunction.MCXENT);
      }
    }
  }
).build();
  DBN d=new DBN.Builder().layerWiseConfiguration(conf).build();
  DataSetIterator iter=new IrisDataSetIterator(150,150);
  DataSet next=iter.next(100);
  next.normalizeZeroMeanZeroUnitVariance();
  d.fit(next);
  Evaluation eval=new Evaluation();
  INDArray output=d.output(next.getFeatureMatrix());
  eval.eval(next.getLabels(),output);
  log.info("Score " + eval.stats());
}
