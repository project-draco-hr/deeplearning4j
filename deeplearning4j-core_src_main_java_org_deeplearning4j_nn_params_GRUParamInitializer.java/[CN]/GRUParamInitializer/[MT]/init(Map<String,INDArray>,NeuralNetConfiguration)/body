{
  Distribution dist=Distributions.createDistribution(conf.getDist());
  int nL=conf.getNOut();
  int nLast=conf.getNIn();
  conf.addVariable(RECURRENT_WEIGHTS);
  conf.addVariable(INPUT_WEIGHTS);
  conf.addVariable(BIAS);
  params.put(RECURRENT_WEIGHTS,WeightInitUtil.initWeights(nL,3 * nL,conf.getWeightInit(),dist));
  params.put(INPUT_WEIGHTS,WeightInitUtil.initWeights(nLast,3 * nL,conf.getWeightInit(),dist));
  params.put(BIAS,Nd4j.zeros(1,3 * nL));
  params.get(RECURRENT_WEIGHTS).data().persist();
  params.get(INPUT_WEIGHTS).data().persist();
  params.get(BIAS).data().persist();
}
