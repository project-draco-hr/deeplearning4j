{
  List<INDArray> list=new ArrayList<>(layers.length);
  for (int i=0; i < topologicalOrder.length; i++) {
    if (!vertices[topologicalOrder[i]].hasLayer())     continue;
    Layer l=vertices[topologicalOrder[i]].getLayer();
    if (backwardOnly && l instanceof BasePretrainNetwork) {
      list.add(((BasePretrainNetwork)l).paramsBackprop());
    }
 else {
      list.add(l.params());
    }
  }
  return Nd4j.toFlattened('f',list);
}
