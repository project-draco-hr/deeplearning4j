{
  if (opt == null) {
    createOptimizationAlgorithm();
  }
  network.setInput(x);
  int epochs=extraParams.length < 3 ? 1000 : (int)extraParams[2];
  opt.setMaxIterations(epochs);
  opt.optimize(epochs);
  network.backProp(lr,epochs,extraParams);
}
