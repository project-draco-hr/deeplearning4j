{
  if (opt == null) {
    if (optimizationAlgorithm == OptimizationAlgorithm.CONJUGATE_GRADIENT) {
      opt=new VectorizedNonZeroStoppingConjugateGradient(this,this);
      ((VectorizedNonZeroStoppingConjugateGradient)opt).setTolerance(tolerance);
    }
 else {
      opt=new VectorizedDeepLearningGradientAscent(this,this);
      ((VectorizedDeepLearningGradientAscent)opt).setTolerance(tolerance);
    }
  }
  int epochs=extraParams.length < 3 ? 1000 : (int)extraParams[2];
  opt.optimize(epochs);
}
