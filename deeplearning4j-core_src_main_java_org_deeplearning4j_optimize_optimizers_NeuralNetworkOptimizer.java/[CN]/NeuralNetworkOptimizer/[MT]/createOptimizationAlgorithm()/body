{
  if (network.conf().getOptimizationAlgo() == OptimizationAlgorithm.CONJUGATE_GRADIENT) {
    opt=new VectorizedNonZeroStoppingConjugateGradient(this,this);
    opt.setTolerance(tolerance);
  }
 else {
    opt=new VectorizedDeepLearningGradientAscent(this,this);
    opt.setTolerance(tolerance);
    if (maxStep > 0)     ((VectorizedDeepLearningGradientAscent)opt).setMaxStepSize(maxStep);
  }
}
