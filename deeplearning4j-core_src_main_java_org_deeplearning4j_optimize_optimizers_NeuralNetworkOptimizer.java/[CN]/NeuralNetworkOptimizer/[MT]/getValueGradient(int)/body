{
  if (iteration >= 1)   extraParams[extraParams.length - 1]=iteration;
  NeuralNetworkGradient g=network.getGradient(extraParams);
  return NDArrays.toFlattened(Arrays.asList(g.getwGradient(),g.getvBiasGradient(),g.gethBiasGradient()));
}
