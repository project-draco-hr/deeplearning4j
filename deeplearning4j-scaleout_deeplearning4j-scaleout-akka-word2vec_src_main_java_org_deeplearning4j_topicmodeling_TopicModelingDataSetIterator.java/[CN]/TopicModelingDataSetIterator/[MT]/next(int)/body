{
  int curr=0;
  if (!hasNext())   throw new IllegalStateException("Unable to getFromOrigin next; no more data found");
  List<DataSet> d=new ArrayList<>();
  while (files.hasNext() && curr < num) {
    File next=files.next();
    INDArray input=vocabCreator.getScoreMatrix(next);
    int comp=(int)input.sum(Integer.MAX_VALUE).element();
    if (comp != 0) {
      String label=next.getParentFile().getName();
      INDArray y=FeatureUtil.toOutcomeVector(labels.indexOf(label),labels.size());
      d.add(new DataSet(input,y));
      curr++;
    }
  }
  return DataSet.merge(d);
}
