{
  if (!dataSetIterator.hasNext()) {
    return Collections.singletonList(new Tuple3<INDArray,Updater,Double>(Nd4j.zeros(network.params().shape()),null,0.0));
  }
  List<DataSet> collect=new ArrayList<>();
  while (dataSetIterator.hasNext()) {
    collect.add(dataSetIterator.next());
  }
  DataSet data=DataSet.merge(collect,false);
  if (log.isDebugEnabled()) {
    log.debug("Training on {} examples with data {}",data.numExamples(),data.labelCounts());
  }
  network.fit(data);
  return Collections.singletonList(new Tuple3<>(network.params(false),network.getUpdater(),network.score()));
}
