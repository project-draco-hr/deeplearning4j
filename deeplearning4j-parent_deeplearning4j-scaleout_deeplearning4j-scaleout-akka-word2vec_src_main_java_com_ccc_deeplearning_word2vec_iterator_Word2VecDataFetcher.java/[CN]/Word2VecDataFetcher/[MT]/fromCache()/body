{
  DoubleMatrix outcomes=null;
  DoubleMatrix input=null;
  input=new DoubleMatrix(batch,vec.getSyn1().columns * vec.getWindow());
  outcomes=new DoubleMatrix(batch,labels.size());
  for (int i=0; i < batch; i++) {
    input.putRow(i,new DoubleMatrix(WindowConverter.asExample(cache.get(i),vec)));
    int idx=labels.indexOf(cache.get(i).getLabel());
    if (idx < 0)     idx=0;
    outcomes.putRow(i,MatrixUtil.toOutcomeVector(idx,labels.size()));
  }
  return new DataSet(input,outcomes);
}
