{
  if (data.isEmpty())   throw new IllegalArgumentException("Unable to merge empty dataset");
  DataSet first=data.get(0);
  int numExamples=totalExamples(data);
  INDArray in=NDArrays.create(numExamples,first.getFeatures().columns());
  INDArray out=NDArrays.create(numExamples,first.getLabels().columns());
  int count=0;
  for (int i=0; i < data.size(); i++) {
    DataSet d1=data.get(i);
    for (int j=0; j < d1.numExamples(); j++) {
      DataSet example=d1.get(j);
      in.putRow(count,example.getFeatures());
      out.putRow(count,example.getLabels());
      count++;
    }
  }
  return new DataSet(in,out);
}
