{
  if (numSamples >= numExamples())   return this;
 else {
    INDArray examples=NDArrays.create(numSamples,getFeatures().columns());
    INDArray outcomes=NDArrays.create(numSamples,numOutcomes());
    Set<Integer> added=new HashSet<Integer>();
    for (int i=0; i < numSamples; i++) {
      int picked=rng.nextInt(numExamples());
      if (!withReplacement)       while (added.contains(picked)) {
        picked=rng.nextInt(numExamples());
      }
      examples.putRow(i,get(picked).getFeatures());
      outcomes.putRow(i,get(picked).getLabels());
    }
    return new DataSet(examples,outcomes);
  }
}
