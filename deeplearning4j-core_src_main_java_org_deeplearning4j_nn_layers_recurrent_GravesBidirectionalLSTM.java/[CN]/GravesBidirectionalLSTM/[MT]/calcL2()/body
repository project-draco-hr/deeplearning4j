{
  if (!conf.isUseRegularization() || conf.getLayer().getL2() <= 0.0)   return 0.0;
  double l2=Transforms.pow(getParam(GravesBidirectionalLSTMParamInitializer.RECURRENT_WEIGHT_KEY_FORWARDS),2).sum(Integer.MAX_VALUE).getDouble(0) + Transforms.pow(getParam(GravesBidirectionalLSTMParamInitializer.INPUT_WEIGHT_KEY_FORWARDS),2).sum(Integer.MAX_VALUE).getDouble(0) + Transforms.pow(getParam(GravesBidirectionalLSTMParamInitializer.RECURRENT_WEIGHT_KEY_BACKWARDS),2).sum(Integer.MAX_VALUE).getDouble(0)+ Transforms.pow(getParam(GravesBidirectionalLSTMParamInitializer.INPUT_WEIGHT_KEY_BACKWARDS),2).sum(Integer.MAX_VALUE).getDouble(0);
  return 0.5 * conf.getLayer().getL2() * l2;
}
