{
  INDArray p2=p.dup();
  INDArray p2Linear=p2.linearView();
  for (int i=0; i < p2.length(); i++) {
    p2Linear.putScalar(i,MathUtils.binomial(rng,n,p2Linear.get(i)));
  }
  return p2;
}
