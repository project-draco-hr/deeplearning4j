{
  INDArray iter=mean.reshape(new int[]{1,mean.length()}).dup();
  INDArray sigmaLinear=sigma.ravel();
  for (int i=0; i < iter.length(); i++) {
    RealDistribution reals=new NormalDistribution(rng,(double)mean.getScalar(i).element(),FastMath.sqrt((double)sigmaLinear.getScalar(i).element()),NormalDistribution.DEFAULT_INVERSE_ABSOLUTE_ACCURACY);
    iter.putScalar(i,reals.sample());
  }
  return iter.reshape(mean.shape());
}
