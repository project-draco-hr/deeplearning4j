{
  int nIn=61;
  int nOut=25;
  TestRnnTimeStep test=new TestRnnTimeStep(nIn,nOut);
  int nTests=5000;
  int nSteps=3;
  INDArray input=Nd4j.rand(new int[]{1,nIn,1});
  for (int i=0; i <= nTests; i++) {
    Map<String,INDArray>[] rnnState=null;
    for (int step=0; step < nSteps; step++) {
      rnnState=test.getEmbedding(input,rnnState);
    }
  }
  long time=test.mid.get();
  System.out.println("Total Time taken by rnn time step is " + time + " ms");
  System.out.println("Average Time taken by rnn time step is " + time / (double)(nTests * nSteps) + " ms");
}
