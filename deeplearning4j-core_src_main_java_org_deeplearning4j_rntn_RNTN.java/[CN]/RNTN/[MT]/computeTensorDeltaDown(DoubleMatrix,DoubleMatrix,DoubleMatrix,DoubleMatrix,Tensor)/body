{
  DoubleMatrix WTDelta=W.transpose().mmul(deltaFull);
  DoubleMatrix WTDeltaNoBias=WTDelta.get(RangeUtils.interval(0,1),RangeUtils.interval(0,deltaFull.rows * 2));
  int size=deltaFull.length;
  DoubleMatrix deltaTensor=new DoubleMatrix(size * 2,1);
  DoubleMatrix fullVector=DoubleMatrix.concatHorizontally(leftVector,rightVector);
  for (int slice=0; slice < size; ++slice) {
    DoubleMatrix scaledFullVector=SimpleBlas.scal(deltaFull.get(slice),fullVector);
    deltaTensor=deltaTensor.add(Wt.getSlice(slice).add(Wt.getSlice(slice).transpose()).mmul(scaledFullVector));
  }
  return deltaTensor.add(WTDeltaNoBias);
}
