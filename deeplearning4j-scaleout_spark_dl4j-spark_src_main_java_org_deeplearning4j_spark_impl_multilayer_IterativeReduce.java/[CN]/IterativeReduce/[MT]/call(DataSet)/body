{
  log.info("Training on " + dataSet.numExamples());
  MultiLayerConfiguration conf=MultiLayerConfiguration.fromJson(json);
  MultiLayerNetwork network=new MultiLayerNetwork(conf);
  network.init();
  network.setParameters(params.value().dup());
  network.fit(dataSet);
  return network.params();
}
