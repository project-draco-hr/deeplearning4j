{
  if (matrix.isMatrix()) {
    BufferedImage img=new BufferedImage(matrix.size(-1),matrix.size(-2),BufferedImage.TYPE_INT_RGB);
    INDArray toRound=matrix;
    WritableRaster r=img.getRaster();
    int[] equiv=new int[matrix.length()];
    for (int i=0; i < equiv.length; i++) {
      equiv[i]=(int)toRound.linearView().getDouble(i) * 256;
    }
    r.setDataElements(0,0,matrix.columns(),matrix.rows(),equiv);
    return img;
  }
 else {
    BufferedImage img=new BufferedImage(matrix.size(-1),matrix.size(-2),BufferedImage.TYPE_INT_ARGB);
    INDArray toRound=matrix;
    WritableRaster r=img.getRaster();
    int[] equiv=new int[matrix.length()];
    for (int i=0; i < equiv.length; i++) {
      equiv[i]=(int)toRound.linearView().getDouble(i) * 256;
    }
    r.setDataElements(0,0,matrix.size(-1),matrix.size(-2),equiv);
    return img;
  }
}
