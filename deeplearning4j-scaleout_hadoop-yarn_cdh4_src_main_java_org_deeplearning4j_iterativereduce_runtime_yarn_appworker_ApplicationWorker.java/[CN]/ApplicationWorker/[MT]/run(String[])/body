{
  if (args.length < 4 || !args[0].equals("--master-addr") || !args[2].equals("--worker-id"))   throw new IllegalArgumentException("Expected two and only two options: --master-addr <host:port> and --worker-id <workerid>");
  String[] masterHostPort=args[1].split(":");
  InetSocketAddress masterAddr=new InetSocketAddress(masterHostPort[0],Integer.parseInt(masterHostPort[1]));
  Configuration conf=getConf();
  ApplicationWorkerService<T> worker=new ApplicationWorkerService(args[3],masterAddr,parser,computable,updateable,conf);
  LOG.info("Starting worker" + ", workerId=" + args[3] + ", masterHost="+ args[1]+ ", parser="+ parser.getClass().getName()+ ", computable="+ computable.getClass().getName()+ ", updateable="+ updateable.getName());
  int rc=worker.run();
  LOG.info("Worker completed with exit code " + rc);
  return rc;
}
