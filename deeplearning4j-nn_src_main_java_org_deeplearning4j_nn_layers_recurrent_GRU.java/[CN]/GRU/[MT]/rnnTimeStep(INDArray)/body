{
  setInput(input);
  INDArray[] activations=activateHelper(false,stateMap.get(STATE_KEY_PREV_ACTIVATION));
  INDArray outAct=activations[0];
  int tLength=outAct.size(2);
  INDArray lastActSlice=outAct.tensorAlongDimension(tLength - 1,1,0);
  stateMap.put(STATE_KEY_PREV_ACTIVATION,lastActSlice.dup());
  return outAct;
}
