{
  MnistDataFetcher fetcher=new MnistDataFetcher(true);
  NeuralNetConfiguration conf=new NeuralNetConfiguration.Builder().momentum(0.9f).iterations(100).lossFunction(LossFunctions.LossFunction.RECONSTRUCTION_CROSSENTROPY).rng(new MersenneTwister(123)).learningRate(1e-1f).nIn(784).nOut(600).build();
  fetcher.fetch(10);
  DataSet d2=fetcher.next();
  INDArray input=d2.getFeatureMatrix();
  LayerFactory layerFactory=LayerFactories.getFactory(DenoisingAutoEncoder.class);
  DenoisingAutoEncoder da=layerFactory.create(conf);
  assertEquals(471784,da.params().length());
  da.fit(input);
  NeuralNetPlotter plotter=new NeuralNetPlotter();
  plotter.plotNetworkGradient(da,da.getGradient(),10);
}
