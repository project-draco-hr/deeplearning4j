{
  DoubleMatrix wxB=visibleSample.mmul(W).addRowVector(hBias);
  double vBiasTerm=SimpleBlas.dot(visibleSample,vBias);
  double hBiasTerm=log(exp(wxB).add(1)).sum();
  return -hBiasTerm - vBiasTerm;
}
