{
  if (input != null && cacheInput)   this.input=input;
  this.lastMiniBatchSize=input.rows;
  if (visibleType == VisibleUnit.GAUSSIAN) {
    this.sigma=MatrixUtil.columnVariance(input);
    if (normalizeByInputRows)     this.sigma.divi(input.rows);
  }
  optimizer=new RBMOptimizer(this,lr,params,optimizationAlgo,lossFunction);
  optimizer.train(input);
}
