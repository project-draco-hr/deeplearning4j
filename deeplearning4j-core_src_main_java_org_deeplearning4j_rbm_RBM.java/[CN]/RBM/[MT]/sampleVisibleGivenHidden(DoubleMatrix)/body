{
  DoubleMatrix v1Mean=propDown(h);
  if (visibleType == VisibleUnit.GAUSSIAN) {
    DoubleMatrix v1Sample=normal(getRng(),v1Mean,1).mulRowVector(sigma);
    return new Pair<>(v1Mean,v1Sample);
  }
 else   if (visibleType == VisibleUnit.LINEAR) {
    DoubleMatrix v1Sample=normal(getRng(),v1Mean,1);
    return new Pair<>(v1Mean,v1Sample);
  }
 else   if (visibleType == VisibleUnit.SOFTMAX) {
    DoubleMatrix v1Sample=softmax(v1Mean);
    return new Pair<>(v1Mean,v1Sample);
  }
 else   if (visibleType == VisibleUnit.BINARY) {
    DoubleMatrix v1Sample=binomial(v1Mean,1,rng);
    return new Pair<>(v1Mean,v1Sample);
  }
  throw new IllegalStateException("Visible type must either be binary,gaussian, softmax, or linear");
}
