{
  DoubleMatrix vMean=h.mmul(W.transpose());
  if (concatBiases)   vMean=DoubleMatrix.concatHorizontally(vMean,vBias);
 else   vMean.addiRowVector(vBias);
  if (visibleType == VisibleUnit.GAUSSIAN) {
    vMean.addi(normal(rng,vMean,1.0));
    return vMean;
  }
 else   if (visibleType == VisibleUnit.LINEAR) {
    vMean=normal(getRng(),vMean,1);
    return vMean;
  }
 else   if (visibleType == VisibleUnit.BINARY) {
    return sigmoid(vMean);
  }
 else   if (visibleType == VisibleUnit.SOFTMAX) {
    return softmax(vMean);
  }
  throw new IllegalStateException("Visible unit type should either be binary or gaussian");
}
