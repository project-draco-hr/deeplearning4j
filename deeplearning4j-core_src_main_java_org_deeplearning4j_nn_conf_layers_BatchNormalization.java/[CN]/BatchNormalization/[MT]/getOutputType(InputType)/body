{
  if (inputType == null || (inputType.getType() != InputType.Type.CNN && inputType.getType() != InputType.Type.CNNFlat)) {
    throw new IllegalStateException("Invalid input type: Batch norm layer expected input of type CNN, got " + inputType);
  }
  return inputType;
}
