{
  if (!canDoForward())   throw new IllegalStateException("Cannot do forward pass: all inputs not set");
  if (layer != null) {
    if (inputs.length > 1)     throw new UnsupportedOperationException("Not implemented");
    INDArray currInput=inputs[0];
    if (layerPreProcessor != null) {
      currInput=layerPreProcessor.preProcess(currInput,graph.batchSize());
    }
    return layer.activate(currInput,training);
  }
 else {
    return node.forward(inputs);
  }
}
