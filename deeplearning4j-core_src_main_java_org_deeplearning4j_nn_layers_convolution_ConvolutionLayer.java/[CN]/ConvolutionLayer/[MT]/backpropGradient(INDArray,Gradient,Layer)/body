{
  INDArray gy=gradient.getGradientFor(ConvolutionParamInitializer.WEIGHT_KEY);
  INDArray biasGradient=gradient.getGradientFor(ConvolutionParamInitializer.BIAS_KEY);
  getParam(ConvolutionParamInitializer.BIAS_KEY).addi(gy.sum(0,2,3));
  INDArray gcol=Nd4j.tensorMmul(getParam(ConvolutionParamInitializer.WEIGHT_KEY),gy.slice(0),new int[][]{{0,1}});
  gcol=Nd4j.rollAxis(gcol,3);
  INDArray z=preOutput(input());
  INDArray weightGradient=Convolution.conv2d(gcol,z,conf.getConvolutionType());
  Gradient retGradient=new DefaultGradient();
  retGradient.setGradientFor(ConvolutionParamInitializer.WEIGHT_KEY,weightGradient);
  retGradient.setGradientFor(ConvolutionParamInitializer.BIAS_KEY,biasGradient);
  return new Pair<>(retGradient,weightGradient);
}
