{
  if (data.isEmpty())   throw new IllegalArgumentException("Unable to merge empty dataset");
  DataSet first=data.get(0);
  int numExamples=totalExamples(data);
  DoubleMatrix in=new DoubleMatrix(numExamples,first.getFirst().columns);
  DoubleMatrix out=new DoubleMatrix(numExamples,first.getSecond().columns);
  int count=0;
  for (int i=0; i < data.size(); i++) {
    DataSet d1=data.get(i);
    for (int j=0; j < d1.numExamples(); j++) {
      DataSet example=d1.get(j);
      in.putRow(count,example.getFirst());
      out.putRow(count,example.getSecond());
      count++;
    }
  }
  return new DataSet(in,out);
}
