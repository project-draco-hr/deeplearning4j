{
  int inputSize=conf.getnIn();
  int hiddenSize=conf.getnIn();
  int outputSize=conf.getnOut();
  conf.addVariable(RECURRENT_WEIGHTS);
  conf.addVariable(DECODER_WEIGHTS);
  conf.addVariable(DECODER_BIAS);
  params.put(RECURRENT_WEIGHTS,WeightInitUtil.initWeights(inputSize + hiddenSize + 1,4 * hiddenSize,conf.getWeightInit(),conf.getDist()));
  params.put(DECODER_WEIGHTS,WeightInitUtil.initWeights(hiddenSize,outputSize,conf.getWeightInit(),conf.getDist()));
  params.put(DECODER_BIAS,Nd4j.zeros(outputSize));
  params.get(RECURRENT_WEIGHTS).data().persist();
  params.get(DECODER_BIAS).data().persist();
  params.get(DECODER_WEIGHTS).data().persist();
}
