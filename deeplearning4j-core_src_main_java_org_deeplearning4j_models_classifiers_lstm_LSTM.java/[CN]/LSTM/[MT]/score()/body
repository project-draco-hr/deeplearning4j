{
  INDArray forward=Activations.softMaxRows().apply(forward(xi,xs));
  return -log(forward.sum(Integer.MAX_VALUE)).getDouble(0);
}
