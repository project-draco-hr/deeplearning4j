{
  INDArray y1=y.linearView();
  double max=y.max(Integer.MAX_VALUE).getDouble(0);
  INDArray e1=exp(y1.rsub(max));
  INDArray p1=e1.divi(e1.sum(Integer.MAX_VALUE));
  y1=log(p1.addi(Nd4j.EPS_THRESHOLD));
  INDArray[] sorted=Nd4j.sortWithIndices(y1,0,true);
  int ix=sorted[0].getInt(0);
  return new Pair<>(ix,sorted[1].getDouble(ix));
}
