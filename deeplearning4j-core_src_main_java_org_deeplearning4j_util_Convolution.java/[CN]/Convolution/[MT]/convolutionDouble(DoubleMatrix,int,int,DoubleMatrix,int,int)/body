{
  int smallWidth=width - kernelWidth + 1;
  int smallHeight=height - kernelHeight + 1;
  DoubleMatrix small=convolution2D(input,width,height,kernel,kernelWidth,kernelHeight);
  DoubleMatrix result=new DoubleMatrix(smallWidth * smallHeight);
  for (int j=0; j < smallHeight; ++j) {
    for (int i=0; i < smallWidth; ++i) {
      result.put(j * smallWidth + i,small.get(i,j));
    }
  }
  return result;
}
