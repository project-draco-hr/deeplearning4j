{
  int smallWidth=width - kernelWidth + 1;
  int smallHeight=height - kernelHeight + 1;
  DoubleMatrix output=new DoubleMatrix(smallWidth,smallHeight);
  for (int i=0; i < smallWidth; ++i) {
    for (int j=0; j < smallHeight; ++j) {
      output.put(i,j,singlePixelConvolution(input,i,j,kernel,kernelWidth,kernelHeight));
    }
  }
  return output;
}
