{
  DoubleMatrix l1=syn0.getRow(w2.index);
  DoubleMatrix l2a=syn1.getRows(w1.points);
  DoubleMatrix fa=sigmoid(MatrixUtil.dot(l1,l2a.transpose()));
  DoubleMatrix ga=DoubleMatrix.ones(fa.length).sub(toMatrix(w1.codes)).sub(fa).mul(alpha);
  DoubleMatrix outer=ga.mmul(l1);
  for (int i=0; i < w1.points.length; i++) {
    DoubleMatrix toAdd=l2a.getRow(i).add(outer.getRow(i));
    syn1.putRow(w1.points[i],toAdd);
  }
  DoubleMatrix updatedInput=l1.add(MatrixUtil.dot(ga,l2a));
  syn0.putRow(w2.index,updatedInput);
}
