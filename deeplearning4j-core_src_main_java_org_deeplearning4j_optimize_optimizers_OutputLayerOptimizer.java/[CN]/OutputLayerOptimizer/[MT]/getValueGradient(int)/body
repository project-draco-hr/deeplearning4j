{
  this.currIteration=currIteration;
  OutputLayerGradient grad=logReg.getGradient(lr);
  if (logReg.getW().length() != grad.getwGradient().length())   throw new IllegalStateException("Illegal length for gradient");
  if (logReg.getB().length() != grad.getbGradient().length())   throw new IllegalStateException("Illegal length for gradient");
  return NDArrays.toFlattened(grad.getwGradient(),grad.getbGradient());
}
