{
  this.currIteration=currIteration;
  OutputLayerGradient grad=logReg.getGradient(lr);
  INDArray ret=NDArrays.create(getNumParameters());
  if (logReg.getW().length() != grad.getwGradient().length())   throw new IllegalStateException("Illegal length for gradient");
  if (logReg.getB().length() != grad.getbGradient().length())   throw new IllegalStateException("Illegal length for gradient");
  for (int i=0; i < ret.length(); i++) {
    if (i < logReg.getW().length())     ret.put(i,grad.getwGradient().getScalar(i));
 else     ret.put(i,grad.getbGradient().getScalar(i - logReg.getW().length()));
  }
  return ret;
}
