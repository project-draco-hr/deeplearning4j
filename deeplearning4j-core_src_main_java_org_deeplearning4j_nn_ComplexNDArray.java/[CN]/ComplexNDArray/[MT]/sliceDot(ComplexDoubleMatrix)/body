{
  int dims=shape.length;
switch (dims) {
case 1:
{
      return ComplexDoubleMatrix.scalar(SimpleBlas.dotc(this,a).real());
    }
case 2:
{
    return ComplexDoubleMatrix.scalar(SimpleBlas.dotc(this,a).real());
  }
}
int sc=shape[0];
ComplexDoubleMatrix d=new ComplexDoubleMatrix(1,sc);
for (int i=0; i < sc; i++) d.put(i,slice(i).dotc(a));
return d;
}
