{
  super.setupSearchState(pair);
  INDArray gradient=(INDArray)searchState.get(GRADIENT_KEY);
  INDArray params=(INDArray)searchState.get(PARAMS_KEY);
  searchState.put("s",new LinkedList<INDArray>());
  searchState.put("y",new LinkedList<INDArray>());
  searchState.put("rho",new LinkedList<Double>());
  searchState.put("oldparams",params.dup());
  searchState.put(SEARCH_DIR,gradient.dup().mul(Nd4j.norm2(gradient).rdivi(1.0).getDouble(0)).negi());
}
