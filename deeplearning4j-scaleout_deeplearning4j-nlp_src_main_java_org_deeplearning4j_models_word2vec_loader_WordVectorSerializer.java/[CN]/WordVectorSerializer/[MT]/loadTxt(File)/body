{
  BufferedReader write=new BufferedReader(new FileReader(path));
  VocabCache cache=new InMemoryLookupCache();
  InMemoryLookupTable l=(InMemoryLookupTable)new InMemoryLookupTable.Builder().vectorLength(100).useAdaGrad(false).cache(cache).build();
  LineIterator iter=IOUtils.lineIterator(write);
  List<INDArray> arrays=new ArrayList<>();
  while (iter.hasNext()) {
    String line=iter.nextLine();
    String[] split=line.split(" ");
    String word=split[0];
    VocabWord word1=new VocabWord(1.0,word);
    cache.addToken(word1);
    cache.addWordToIndex(cache.numWords(),word);
    cache.putVocabWord(word);
    INDArray row=Nd4j.create(new FloatBuffer(split.length - 1));
    for (int i=1; i < split.length; i++)     row.putScalar(i - 1,Float.parseFloat(split[i]));
    arrays.add(row);
  }
  INDArray syn=Nd4j.create(new int[]{arrays.size(),arrays.get(0).columns()});
  for (int i=0; i < syn.rows(); i++)   syn.putRow(i,arrays.get(i));
  l.setSyn0(syn);
  iter.close();
  return new Pair<>((WeightLookupTable)l,cache);
}
