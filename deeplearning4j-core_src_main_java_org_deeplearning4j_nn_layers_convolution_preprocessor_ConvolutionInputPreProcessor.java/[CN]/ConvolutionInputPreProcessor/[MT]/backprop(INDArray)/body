{
  if (shape == null || ArrayUtil.prod(shape) != output.length()) {
    if (output.shape().length == 4) {
      int[] otherOutputs=new int[3];
      int[] outputShape=output.shape();
      System.arraycopy(outputShape,1,otherOutputs,0,otherOutputs.length);
      shape=new int[]{output.shape()[0],ArrayUtil.prod(otherOutputs)};
    }
 else     if (output.shape().length == 3) {
      int[] otherOutputs=new int[2];
      int[] outputShape=output.shape();
      System.arraycopy(outputShape,1,otherOutputs,0,otherOutputs.length);
      shape=new int[]{output.shape()[0],ArrayUtil.prod(otherOutputs)};
    }
  }
  return output.reshape(shape);
}
