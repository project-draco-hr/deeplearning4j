{
  if (shape == null || ArrayUtil.prod(shape) != output.length()) {
    int[] otherOutputs=null;
    if (output.shape().length == 2) {
      return output;
    }
 else     if (output.shape().length == 4) {
      otherOutputs=new int[3];
    }
 else     if (output.shape().length == 3) {
      otherOutputs=new int[2];
    }
    int outputShape=output.shape()[0];
    System.arraycopy(output.shape(),1,otherOutputs,0,otherOutputs.length);
    shape=new int[]{outputShape,ArrayUtil.prod(otherOutputs)};
  }
  return output.reshape(shape);
}
