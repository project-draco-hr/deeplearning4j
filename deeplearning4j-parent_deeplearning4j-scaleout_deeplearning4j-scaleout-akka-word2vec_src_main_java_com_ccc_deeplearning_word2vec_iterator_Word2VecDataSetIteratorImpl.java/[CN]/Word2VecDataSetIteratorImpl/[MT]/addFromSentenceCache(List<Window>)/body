{
  while (!cache.isEmpty() && nextDataSet.size() < batchSize) {
    String next=cache.remove(0);
    List<Window> nextWindows=Windows.windows(next);
    while (nextDataSet.size() < batchSize && !nextWindows.isEmpty()) {
      Window nextWindow=nextWindows.remove(0);
      nextDataSet.add(nextWindow);
    }
    windows.addAll(nextWindows);
  }
}
