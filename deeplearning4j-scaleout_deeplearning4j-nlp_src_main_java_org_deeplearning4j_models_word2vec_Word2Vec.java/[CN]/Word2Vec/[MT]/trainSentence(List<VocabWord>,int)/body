{
  if (g == null)   g=new XorShift1024StarRandomGenerator(seed);
  numWordsSoFar.getAndAdd(sentence.size());
  if (doc % 1000 == 0) {
    alpha.set(Math.max(minLearningRate,alpha.get() * (1 - (1.0 * (double)doc / (double)vectorizer.index().numDocuments()))));
    log.info("Num words so far " + numWordsSoFar.get() + " alpha is "+ alpha.get());
  }
  if (sentence.isEmpty())   return;
  for (int i=0; i < sentence.size(); i++)   skipGram(i,sentence,(int)g.nextDouble() % window);
}
