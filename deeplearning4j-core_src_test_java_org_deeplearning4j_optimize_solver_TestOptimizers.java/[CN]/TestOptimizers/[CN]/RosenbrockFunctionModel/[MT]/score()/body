{
  INDArray paramExceeds5=parameters.cond(new Condition(){
    @Override public Boolean apply(    Number input){
      return Math.abs(input.doubleValue()) > 5.0;
    }
    @Override public Boolean apply(    IComplexNumber input){
      throw new UnsupportedOperationException();
    }
  }
);
  int nExceeds5=paramExceeds5.sum(Integer.MAX_VALUE).getInt(0);
  if (nExceeds5 > 0)   return Double.POSITIVE_INFINITY;
  int nDims=parameters.length();
  double score=0.0;
  for (int i=0; i < nDims - 1; i++) {
    double xi=parameters.getDouble(i);
    double xi1=parameters.getDouble(i + 1);
    score+=100.0 * Math.pow((xi1 - xi * xi),2.0) + (xi - 1) * (xi - 1);
  }
  return score;
}
