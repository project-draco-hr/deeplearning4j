{
  if (input != null)   this.input=input;
  this.lastMiniBatchSize=input.rows();
  NeuralNetworkGradient gradient=getGradient(new Object[]{k,learningRate,-1});
  double norm=gradient.getwGradient().norm2(Integer.MAX_VALUE).getDouble(0);
  getW().addi(gradient.getwGradient());
  gethBias().addi(gradient.gethBiasGradient());
  getvBias().addi(gradient.getvBiasGradient());
}
