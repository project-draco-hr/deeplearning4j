{
  if (training && conf.getDropOut() > 0) {
    this.dropoutMask=Dropout.applyDropout(input,conf.getDropOut(),dropoutMask);
  }
  INDArray ret=null;
  int numFeatureMaps=ConvolutionUtils.numFeatureMap(conf);
  for (int i=0; i < input.slices(); i++) {
    INDArray downSampled=Transforms.downSample(input.slice(i),conf.getStride());
    if (ret == null) {
      ret=Nd4j.create(Ints.concat(new int[]{input.slices(),numFeatureMaps},downSampled.shape()));
    }
    ret.putSlice(i,downSampled);
  }
  return ret;
}
