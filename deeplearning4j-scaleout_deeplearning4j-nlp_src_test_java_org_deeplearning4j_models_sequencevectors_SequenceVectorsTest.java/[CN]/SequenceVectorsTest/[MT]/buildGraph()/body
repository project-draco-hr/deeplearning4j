{
  File nodes=new File("/ext/Temp/BlogCatalog/nodes.csv");
  CSVRecordReader reader=new CSVRecordReader(0,",");
  reader.initialize(new FileSplit(nodes));
  List<Blogger> bloggers=new ArrayList<>();
  int cnt=0;
  while (reader.hasNext()) {
    List<Writable> lines=new ArrayList<>(reader.next());
    Blogger blogger=new Blogger(lines.get(0).toInt());
    blogger.setIndex(cnt);
    bloggers.add(blogger);
    cnt++;
  }
  reader.close();
  Graph<Blogger,Void> graph=new Graph<Blogger,Void>(bloggers,true);
  File edges=new File("/ext/Temp/BlogCatalog/edges.csv");
  reader=new CSVRecordReader(0,",");
  reader.initialize(new FileSplit(edges));
  while (reader.hasNext()) {
    List<Writable> lines=new ArrayList<>(reader.next());
    int from=lines.get(0).toInt();
    int to=lines.get(1).toInt();
    graph.addEdge(from - 1,to - 1,null,true);
    graph.addEdge(to - 1,from - 1,null,true);
  }
  return graph;
}
