{
  if (clientResourceManager == null)   throw new IllegalStateException("Cannot submit an application without connecting to resource manager!");
  ApplicationSubmissionContext appCtx=Records.newRecord(ApplicationSubmissionContext.class);
  appCtx.setApplicationId(appId);
  appCtx.setApplicationName(appName);
  appCtx.setQueue("default");
  appCtx.setUser(UserGroupInformation.getCurrentUser().getShortUserName());
  Priority prio=Records.newRecord(Priority.class);
  prio.setPriority(0);
  appCtx.setPriority(prio);
  ContainerLaunchContext containerCtx=Records.newRecord(ContainerLaunchContext.class);
  containerCtx.setLocalResources(localResources);
  containerCtx.setCommands(commands);
  containerCtx.setEnvironment(env);
  containerCtx.setUser(UserGroupInformation.getCurrentUser().getShortUserName());
  Resource capability=Records.newRecord(Resource.class);
  capability.setMemory(memory);
  containerCtx.setResource(capability);
  appCtx.setAMContainerSpec(containerCtx);
  SubmitApplicationRequest submitReq=Records.newRecord(SubmitApplicationRequest.class);
  submitReq.setApplicationSubmissionContext(appCtx);
  LOG.info("Submitting application to ASM");
  clientResourceManager.submitApplication(submitReq);
}
