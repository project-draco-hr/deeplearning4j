{
  DataSetIterator irisData=new IrisDataSetIterator(150,150);
  DataSet next=irisData.next();
  next.normalizeZeroMeanZeroUnitVariance();
  int numExamples=next.numExamples();
  log.info("Training on " + numExamples);
  GaussianRectifiedLinearRBM r=new GaussianRectifiedLinearRBM.Builder().numberOfVisible(irisData.inputColumns()).useAdaGrad(true).numHidden(10).normalizeByInputRows(false).useRegularization(false).build();
  r.trainTillConvergence(next.getFirst(),1e-3,new Object[]{1,1e-3,2000});
  log.info("\nData " + String.valueOf("\n" + next.getFirst()).replaceAll(";","\n"));
  log.info("\nReconstruct " + String.valueOf("\n" + r.reconstruct(r.getInput())).replaceAll(";","\n"));
}
