{
  INDArray test=NDArrays.create(NDArrays.linspace(1,4,4).data(),new int[]{2,2});
  final AtomicInteger count=new AtomicInteger(0);
  test.iterateOverDimension(1,new SliceOp(){
    @Override public void operate(    DimensionSlice nd){
      log.info("Operator " + nd);
      INDArray test=(INDArray)nd.getResult();
      if (count.get() == 0) {
        INDArray firstDimension=NDArrays.create(new double[]{1,2},new int[]{2});
        assertEquals(firstDimension,test);
      }
 else {
        INDArray firstDimension=NDArrays.create(new double[]{3,4},new int[]{2});
        assertEquals(firstDimension,test);
      }
      count.incrementAndGet();
    }
    /** 
 * Operates on an ndarray slice
 * @param nd the result to operate on
 */
    @Override public void operate(    INDArray nd){
      log.info("Operator " + nd);
      INDArray test=nd;
      if (count.get() == 0) {
        INDArray firstDimension=NDArrays.create(new double[]{1,2},new int[]{2});
        assertEquals(firstDimension,test);
      }
 else {
        INDArray firstDimension=NDArrays.create(new double[]{3,4},new int[]{2});
        assertEquals(firstDimension,test);
      }
      count.incrementAndGet();
    }
  }
,false);
  count.set(0);
  test.iterateOverDimension(0,new SliceOp(){
    @Override public void operate(    DimensionSlice nd){
      log.info("Operator " + nd);
      INDArray test=(INDArray)nd.getResult();
      if (count.get() == 0) {
        INDArray firstDimension=NDArrays.create(new double[]{1,3},new int[]{2});
        assertEquals(firstDimension,test);
      }
 else {
        INDArray firstDimension=NDArrays.create(new double[]{2,4},new int[]{2});
        assertEquals(firstDimension,test);
      }
      count.incrementAndGet();
    }
    /** 
 * Operates on an ndarray slice
 * @param nd the result to operate on
 */
    @Override public void operate(    INDArray nd){
      log.info("Operator " + nd);
      INDArray test=nd;
      if (count.get() == 0) {
        INDArray firstDimension=NDArrays.create(new double[]{1,3},new int[]{2});
        assertEquals(firstDimension,test);
      }
 else {
        INDArray firstDimension=NDArrays.create(new double[]{2,4},new int[]{2});
        assertEquals(firstDimension,test);
      }
      count.incrementAndGet();
    }
  }
,false);
}
