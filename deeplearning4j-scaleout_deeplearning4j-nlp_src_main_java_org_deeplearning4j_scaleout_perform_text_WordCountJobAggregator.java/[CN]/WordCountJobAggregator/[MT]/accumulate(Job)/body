{
  Counter<String> wordCounts=(Counter<String>)job.getResult();
  Set<String> seen=new HashSet<>();
  for (  String word : wordCounts.keySet()) {
    vocabCache.incrementWordCount(word,(int)wordCounts.getCount(word));
    if (!seen.contains(word)) {
      vocabCache.incrementTotalDocCount();
      vocabCache.incrementDocCount(word,1);
    }
    VocabWord token=vocabCache.tokenFor(word);
    if (token == null) {
      token=new VocabWord(wordCounts.getCount(word),word);
      vocabCache.addToken(token);
    }
 else     if (vocabCache.wordFrequency(word) >= minWordFrequency) {
      VocabWord vocabWord=vocabCache.wordFor(word);
      if (vocabWord == null) {
        vocabCache.putVocabWord(word);
      }
    }
  }
}
