{
  int vocabSize=syn0.rows();
  table=Nd4j.create(new FloatBuffer(tableSize));
  double trainWordsPow=0.0;
  for (  String word : vocab.words()) {
    trainWordsPow+=Math.pow(vocab.wordFrequency(word),power);
  }
  for (  String word : vocab.words()) {
    double d1=Math.pow(vocab.wordFrequency(word),power) / trainWordsPow;
    for (int i=0; i < tableSize; i++) {
      int wordIdx=vocab.indexOf(word);
      if (wordIdx < 0)       continue;
      table.putScalar(i,wordIdx);
      double mul=i * 1.0 / (double)tableSize;
      if (mul > d1) {
        wordIdx++;
        String wordAtIndex=vocab.wordAtIndex(wordIdx);
        if (wordAtIndex == null)         continue;
        d1+=Math.pow(vocab.wordFrequency(wordAtIndex),power) / trainWordsPow;
      }
    }
  }
}
