{
  JavaSparkContext sc=new JavaSparkContext(conf);
  JavaRDD<String> corpusRDD=getCorpusRDD(sc);
  Broadcast<Map<String,Object>> broadcastTokenizerVarMap=sc.broadcast(word2vec.getTokenizerVarMap());
  TextPipeline pipeline=new TextPipeline(corpusRDD,broadcastTokenizerVarMap);
  JavaRDD<List<String>> tokenizedRDD=pipeline.tokenize();
  assertEquals(tokenizedRDD.first(),Arrays.asList("this","is","a","strange","strange","world"));
  sc.stop();
}
