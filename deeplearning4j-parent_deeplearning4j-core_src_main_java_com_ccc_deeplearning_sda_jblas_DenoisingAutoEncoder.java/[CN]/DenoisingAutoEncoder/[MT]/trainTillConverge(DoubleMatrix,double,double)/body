{
  boolean done=false;
  Double currBestError=null;
  while (!done) {
    if (done)     break;
    DoubleMatrix hBias=this.hBias.dup();
    DoubleMatrix vBias=this.vBias.dup();
    DoubleMatrix W=this.W.dup();
    train(x,lr,corruptionLevel);
    lr*=0.95;
    if (currBestError != null) {
      Double currError=negativeLoglikelihood(corruptionLevel);
      if (currError <= currBestError) {
        log.info("Found new best negative log likelihood " + currError + " the current reconstruction entropy is "+ getReConstructionCrossEntropy());
        Double diff=Math.abs(currError - currBestError);
        if (diff <= 0.000001) {
          log.info("Converged at " + currError);
          done=true;
          break;
        }
 else         currBestError=currError;
      }
 else       if (currError > currBestError) {
        this.W=W;
        this.vBias=vBias;
        this.hBias=hBias;
        log.info("Converged at " + currError + " due to greater error where the best was "+ currBestError);
        done=true;
        break;
      }
    }
 else     currBestError=negativeLoglikelihood(corruptionLevel);
  }
}
