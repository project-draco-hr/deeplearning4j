{
  File f=new File("twoandfours.bin");
  if (!f.exists())   Create2sAnd4sDataSet.main(null);
  DataSet twosAndFours=DataSet.load(f);
  DataSetIterator iter=new ListDataSetIterator(twosAndFours.asList(),10);
  CDBN dbn=null;
  if (args.length >= 1) {
    dbn=SerializationUtils.readObject(new File(args[0]));
  }
  while (iter.hasNext()) {
    DataSet next=iter.next();
    dbn.finetune(next.getSecond(),0.01,1000);
  }
  iter.reset();
  SerializationUtils.saveObject(dbn,new File("twosandfoursfinetuned.bin"));
  Evaluation eval=new Evaluation();
  while (iter.hasNext()) {
    DataSet next=iter.next();
    DoubleMatrix predict=dbn.predict(next.getFirst());
    DoubleMatrix labels=next.getSecond();
    eval.eval(labels,predict);
    log.info("Current stats " + eval.stats());
  }
  log.info("Prediciton f scores and accuracy");
  log.info(eval.stats());
}
