{
  if (output.rank() != 3)   throw new IllegalArgumentException("Invalid input: expect NDArray with rank 3 (i.e., epsilons from RNN layer)");
  INDArray permuted=output.permute(0,2,1);
  permuted=permuted.dup();
  return permuted.reshape(miniBatchSize * timeSeriesLength,rnnLayerSize);
}
