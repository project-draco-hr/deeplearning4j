{
  if (!canDoBackward())   throw new IllegalStateException("Cannot do backward pass: all epsilons not set");
  if (layer != null) {
    INDArray epsTotal;
    if (epsilons.length == 1)     epsTotal=epsilons[0];
 else {
      epsTotal=epsilons[0].dup();
      for (int i=1; i < epsilons.length; i++) {
        epsTotal.addi(epsilons[i]);
      }
    }
    Pair<Gradient,INDArray> pair=layer.backpropGradient(epsTotal);
    return new Pair<Gradient,INDArray[]>(pair.getFirst(),new INDArray[]{pair.getSecond()});
  }
 else {
    return new Pair<>(null,node.backward(epsilons));
  }
}
