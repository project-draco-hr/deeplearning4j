{
  if (dropoutMask == null || !Shape.shapeEquals(input.shape(),dropoutMask.shape())) {
    double scale=1 / (1 - dropout);
    dropoutMask=Nd4j.rand(input.shape()).lti(1 - dropout).muli(scale);
  }
  input.muli(dropoutMask);
  return dropoutMask;
}
