{
  MatrixUtil.ensureValidOutcomeMatrix(labels);
  DoubleMatrix layerInput=network.sigmoidLayers[network.sigmoidLayers.length - 1].sample_h_given_v();
  network.logLayer.input=layerInput;
  network.logLayer.labels=labels;
  LogisticRegressionOptimizer opt=new LogisticRegressionOptimizer(network.logLayer,lr);
  MyConjugateGradient g=new MyConjugateGradient(opt);
  g.optimize();
  network.backProp(lr,epochs);
}
