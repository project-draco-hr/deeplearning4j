{
  MatrixUtil.ensureValidOutcomeMatrix(labels);
  DoubleMatrix layerInput=network.sigmoidLayers[network.sigmoidLayers.length - 1].sample_h_given_v();
  network.logLayer.input=layerInput;
  network.logLayer.labels=labels;
  for (int i=0; i < epochs; i++) {
    network.logLayer.train(layerInput,labels,lr);
    lr*=network.learningRateUpdate;
    log.info("Negative log likelihood on epoch " + i + " "+ network.negativeLogLikelihood());
  }
}
