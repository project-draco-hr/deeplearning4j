{
  MnistDataFetcher fetcher=new MnistDataFetcher();
  fetcher.fetch(1200);
  DataSet first=fetcher.next();
  first.roundToTheNearest(10);
  int numIns=first.getFirst().columns;
  int numLabels=first.getSecond().columns;
  int[] layerSizes=new int[2];
  Arrays.fill(layerSizes,300);
  double lr=0.1;
  StackedDenoisingAutoEncoder sda=new StackedDenoisingAutoEncoder.Builder().numberOfInputs(numIns).numberOfOutPuts(numLabels).withRng(new MersenneTwister(123)).hiddenLayerSizes(layerSizes).build();
  sda.pretrain(first.getFirst(),lr,0.5,2000);
  sda.finetune(first.getSecond(),lr,2000);
  DoubleMatrix predicted=sda.predict(first.getFirst());
  Evaluation eval=new Evaluation();
  eval.eval(first.getSecond(),predicted);
  log.info(eval.stats());
}
