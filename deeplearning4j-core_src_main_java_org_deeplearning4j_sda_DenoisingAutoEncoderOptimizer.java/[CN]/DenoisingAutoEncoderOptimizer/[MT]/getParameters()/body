{
  double corruptionLevel=(double)extraParams[0];
  NeuralNetworkGradient gradient=network.getGradient(new Object[]{corruptionLevel,lr,currIteration});
  DoubleMatrix L_W=gradient.getwGradient();
  DoubleMatrix L_vbias_mean=gradient.getvBiasGradient();
  DoubleMatrix L_hbias_mean=gradient.gethBiasGradient();
  double[] buffer=new double[getNumParameters()];
  int idx=0;
  for (int i=0; i < L_W.length; i++) {
    buffer[idx++]=L_W.get(i);
  }
  for (int i=0; i < L_vbias_mean.length; i++) {
    buffer[idx++]=L_vbias_mean.get(i);
  }
  for (int i=0; i < L_hbias_mean.length; i++) {
    buffer[idx++]=L_hbias_mean.get(i);
  }
  return new DoubleMatrix(buffer);
}
