{
  float corruptionLevel=(float)extraParams[0];
  NeuralNetworkGradient gradient=network.getGradient(new Object[]{corruptionLevel,lr,currIteration});
  INDArray L_W=gradient.getwGradient().ravel();
  INDArray L_vbias_mean=gradient.getvBiasGradient();
  INDArray L_hbias_mean=gradient.gethBiasGradient();
  float[] buffer=new float[getNumParameters()];
  int idx=0;
  for (int i=0; i < L_W.length(); i++) {
    buffer[idx++]=(float)L_W.getScalar(i).element();
  }
  for (int i=0; i < L_vbias_mean.length(); i++) {
    buffer[idx++]=(float)L_vbias_mean.getScalar(i).element();
  }
  for (int i=0; i < L_hbias_mean.length(); i++) {
    buffer[idx++]=(float)L_hbias_mean.getScalar(i).element();
  }
  return NDArrays.create(buffer);
}
