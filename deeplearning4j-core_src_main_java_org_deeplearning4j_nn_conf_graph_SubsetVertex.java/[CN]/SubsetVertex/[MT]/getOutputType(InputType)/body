{
  if (vertexInputs.length != 1) {
    throw new InvalidInputTypeException("SubsetVertex expects single input type. Received: " + Arrays.toString(vertexInputs));
  }
  if (vertexInputs[0].getType() == InputType.Type.CNN) {
    InputType.InputTypeConvolutional conv=(InputType.InputTypeConvolutional)vertexInputs[0];
    int depth=conv.getDepth();
    if (to >= depth) {
      throw new InvalidInputTypeException("Invalid range: Cannot select depth subset [" + from + ","+ to+ "] inclusive from CNN activations with "+ " [depth,width,height] = ["+ depth+ ","+ conv.getWidth()+ ","+ conv.getHeight()+ "]");
    }
    return InputType.convolutional(from - to + 1,conv.getWidth(),conv.getHeight());
  }
 else {
    return vertexInputs[0];
  }
}
