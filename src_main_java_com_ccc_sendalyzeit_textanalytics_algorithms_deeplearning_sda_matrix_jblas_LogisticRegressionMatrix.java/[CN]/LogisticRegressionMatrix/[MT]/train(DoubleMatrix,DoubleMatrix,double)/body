{
  DoubleMatrix mul=x.mmul(W);
  DoubleMatrix p_y_given_x=softmax(mul.addRowVector(b));
  DoubleMatrix dy=y.sub(p_y_given_x);
  DoubleMatrix mult2=x.transpose().mmul(dy);
  W=W.add(mult2);
  b=b.add(MatrixUtil.columnWiseMean(p_y_given_x,0).mul(lr));
}
