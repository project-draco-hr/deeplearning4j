{
  if (message instanceof DistributedPubSubMediator.SubscribeAck) {
    log.info("Susbcribed");
  }
 else   if (message instanceof ResetMessage) {
    iter.reset();
    numTimesReset++;
  }
 else   if (message instanceof ShutdownMessage) {
    log.info("Shutting down system for worker with address " + Cluster.get(context().system()).selfAddress().toString());
    if (!context().system().isTerminated())     context().system().shutdown();
  }
 else   if (iter.hasNext()) {
    mediator.tell(new DistributedPubSubMediator.Publish(MasterActor.MASTER,iter.next()),mediator);
  }
 else   unhandled(message);
}
