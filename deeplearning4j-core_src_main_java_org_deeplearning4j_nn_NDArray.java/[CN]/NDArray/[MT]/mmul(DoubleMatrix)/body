{
  NDArray arr=NDArray.wrap(this,a);
  List<DoubleMatrix> ret=new ArrayList<>();
  if (shape().length == 2) {
    rows=shape[0];
    columns=shape[1];
    return NDArray.wrap(super.mmul(a));
  }
  for (int i=0; i < shape.length; i++) {
    ret.add(slice(i).mmul(arr.slice(i)));
  }
  return new NDArray(ret,ArrayUtil.consArray(shape[0],new int[]{ret.get(0).rows,ret.get(0).columns}));
}
