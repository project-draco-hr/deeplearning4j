{
  String lockPath=new ZookeeperPathBuilder().setHost(host).setPort(port).addPath("hdfslock2").build().replaceAll("//","/");
  StringBuffer sb=new StringBuffer();
  for (  Path path : paths) {
    sb.append(path.toUri().toString() + "\n");
  }
  try {
    zk.create(lockPath,sb.toString().getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
 catch (  KeeperException.SessionExpiredException e) {
    log.error("Session expired...trying again");
    if (zk != null)     zk.close();
    zk=new ZookeeperBuilder().setHost(host).setPort(port).build();
    create(paths);
  }
catch (  KeeperException.NodeExistsException e) {
    log.warn("Node exists...deleting");
    zk.delete(lockPath,-1);
    zk.create(lockPath,sb.toString().getBytes(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
  }
catch (  Exception e) {
    log.error("Unknown error...trying again");
    if (zk != null)     zk.close();
    zk=new ZookeeperBuilder().setHost(host).setPort(port).build();
    create(paths);
  }
}
