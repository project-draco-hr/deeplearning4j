{
  if (value instanceof IComplexNDArray) {
    IComplexNumber element=(IComplexNumber)value.element();
    IComplexNumber ret=ComplexUtil.tanh(element);
    if (ret.realComponent().doubleValue() < -1)     ret.set(-1,ret.imaginaryComponent().doubleValue());
    if (ret.realComponent().doubleValue() > 1)     ret.set(1,ret.imaginaryComponent().doubleValue());
    return NDArrays.scalar(ret);
  }
 else {
    double d=(double)value.element();
    double ret=Math.tanh(d);
    if (ret < -1)     return NDArrays.scalar(-1);
 else     if (ret > 1)     return NDArrays.scalar(1);
 else     return NDArrays.scalar(ret);
  }
}
